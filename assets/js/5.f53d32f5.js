(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{483:function(s,a){s.exports="data:image/png;base64,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"},543:function(s,a,t){s.exports=t.p+"assets/img/362d22168bf344687ec0c206aa115807.16cc12c2.jpg"},544:function(s,a,t){s.exports=t.p+"assets/img/image-20220804223138651.ef678175.png"},545:function(s,a,t){s.exports=t.p+"assets/img/6e7d7bd54d7a4eb67918080863d354d7.e6a1f3ed.png"},546:function(s,a,t){s.exports=t.p+"assets/img/2ccafe41de9bd7f8dec4658f004310d6.0ef5d37d.png"},547:function(s,a,t){s.exports=t.p+"assets/img/71f41d46cc5c0405f4d4dc944b4350c9.b6ce3dcb.jpg"},548:function(s,a,t){s.exports=t.p+"assets/img/image-20220804221855449.e6ca8d5c.png"},549:function(s,a,t){s.exports=t.p+"assets/img/136bc2f01919edcb8271df6f7e71af40.235b541b.jpg"},550:function(s,a,t){s.exports=t.p+"assets/img/image-20220804222212087.b9421cb9.png"},551:function(s,a,t){s.exports=t.p+"assets/img/image-20220804223321167.4b67e2f9.png"},552:function(s,a,t){s.exports=t.p+"assets/img/f8d538f9201e3ebee37dfdcd1922e9df.e409284b.jpg"},553:function(s,a,t){s.exports=t.p+"assets/img/2a2dba7f07581fd055d9cd5a3aa8388e.5d9679c8.jpg"},554:function(s,a,t){s.exports=t.p+"assets/img/image-20220804195402870.24199289.png"},555:function(s,a,t){s.exports=t.p+"assets/img/image-20220804195432673.b6209afe.png"},556:function(s,a,t){s.exports=t.p+"assets/img/image-20220714133617856.46f2a800.png"},557:function(s,a,t){s.exports=t.p+"assets/img/image-20220807183231101.ef7b4ced.png"},558:function(s,a,t){s.exports=t.p+"assets/img/0.08703112216569037.132e239e.png"},559:function(s,a){s.exports="data:image/png;base64,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"},560:function(s,a,t){s.exports=t.p+"assets/img/image-20220715000533951.156ea525.png"},561:function(s,a,t){s.exports=t.p+"assets/img/image-20220714235426120.ce35c1b1.png"},562:function(s,a,t){s.exports=t.p+"assets/img/image-20220715004850504.66975d7f.png"},563:function(s,a){s.exports="data:image/png;base64,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EBERkXAsMIiIiEg4FhhEREQkHAsMIiIiEo4FBhEREQm3yOoOJKIjR47g5ZdfRiAQQCAQQDAYtLpLcS85ORlZWVmQZRkPPvggHA6H1V0isgTzwzzmR3xigSHQu+++iz179uCNN96wuiu288UXX+Dw4cM4fPgw/vSnP2H79u249957re4WUcwwP+aP+RGfWGAI0tnZiV//+te4cOECbrjhBlRUVOD222/HLbfcwmp6kubmZjz77LMAgMrKStx3333IyMjA8ePHsW/fPrz22muorq7Gc889h+zsbIt7SxR9zA/jmB/2wQJDgH379uGZZ54BADz++OP40Y9+hGuuucbiXsWnY8eOoaWlBVdffTV+97vf4a677tLvW7duHdatW4enn34aL7zwAn71q1+htbUVN9xwg4U9Joou5odxzA974SHPBfL7/Xo4PPHEE6isrGQ4zODLL7/Ejh07cOnSJfziF7+ICIdwTz75JO699158+umn2LZtW4x7SRQ7zA/jmB/2wwJjAT777DN4vV4AwE9/+lOUl5db3KP4tn//fnz88cf45je/iR/84AezPra2thYrVqxAf38/FEWJUQ+JYof5YQ7zw35YYCzA008/jbGxMaxfvx6bN2+2ujtx7csvv8Rzzz0HAPjZz3425+PT0tLw8MMPAwCampqi2jciKzA/jGN+2BMLjHnq7e3FgQMHsHTpUmzfvh1JSUlWdymuvfLKK/rsIysry9BzSktLkZaWhv7+frz99ttR7iFR7DA/zGF+2BMLjHn6/e9/DwB49NFHsXLlSot7E//+/Oc/AwAqKioMPyclJQWlpaUAgJdffjkq/SKyAvPDHOaHPbHAmId//vOf6O/vx/Lly+fcCyTg3//+N44cOYLU1NQZD2bN5Dvf+Q4A4PXXX8elS5ei0T2imGJ+mMP8sC8WGPPwwgsvAAAeeughnvg2oKurC1999RU2bNiAxYsXm3rumjVrcOutt+I///kPjh49GqUeEsUO88Mc5od9scAw6fTp0+ju7obD4UBZWZnV3bGFv/71rwCAgoKCeT3/gQceAAAcOHBAWJ+IrMD8MI/5YV8sMEx67bXXoKoqiouLcd1111ndnbgXDAZx/PhxfO1rX0Nubu682vjWt74FAPy4Gdke88Mc5oe9scAwSaum77vvPot7Yg/vvfceQqEQbrvtNqSlpc2rjVtvvRXJyck4ceIEzpw5I7iHRLHD/DCH+WFvLDBM0PbxUlJScOedd1rdHVs4duwYACzo57V48WKsXbsWoVAIAwMDorpGFFPMD/OYH/bGAsME7STyPffcY/qw0ZVqaGgIALBhw4YFtaN9aREPapFdMT/MY37YGwsME7Tlzfz8fIt7Yh/aDGTdunULakebwbz11lsL7hORFZgf5jE/7I0FhkEXL17E4OAgAOCee+6xuDf2cObMGYyNjcHlcmHZsmULaiszMxMAcPz4cYRCIRHdI4oZ5od5zA/7Y4Fh0EcffYQLFy4gPT0d119/vdXdsYWPP/4YAOByuRbc1o033oilS5fiwoUL+PTTTxfcHlEsMT/MY37YHwsMg44fPw7g8l4eze3kyZMAxAQEANxyyy0ALgcPkV0wP8xjftgfCwyD3nnnHQAMCDO0gXzTTTcJaU8LCC14iOyC+WEe88P+WGAY9P777wNY2MelrjTaQBYdEJyBkN0wP8xjftgfCwyD3n33XSxZsgRr1661uiu2IXIPFeAMhOyL+WEe88P+WGAYMDo6ivPnz2PlypVYtGiR1d2xjdOnTwOAsENtTqcTAPjX+MhWmB/zw/ywPxYYBoyMjAAAVqxYYXFP7OOrr77Cf//7XyQlJSE1NVVImw6HA8DE9xMQ2QXzwzzmR2JggWGAFhD8eJlxwWAQoVAI1113Ha666iohbWrfRcCAIDthfpjH/EgMLDAM4AzEPG0Qz/cLiqazdOlSLF68GKqq4osvvhDWLlE0MT/MY34kBhYYBnAGYp4WENqypChc5iS7YX6Yx/xIDCwwDOAMxLxoBQSXOclumB/mMT8SAwsMA7RTxyKX6xLd+Pg4AAg7oKW57rrrItoninfMD/OYH4mBBYYBFy5cAABIkmRxT+xD+5ktWbJEaLva/wOtfaJ4x/wwj/mRGFhgGMCAME9VVQDif2Za4GjtE8U7O+dHMBhEVVUVAoFATK/L/EgMLDAM0H4ZRVfTwMQArqiogKIowtu2UrRnIAwIsguR+REIBPDII4/E/A0/1pgfiYEFhgF2noFYJdozEC5xkl0wP8xjfiQGFhgGRGsFIxAI4Mc//jEGBwdRWVmJioqKWU83e71eeL1e/d+TVz+0f8uyPKUtv98PWZan3KcoCmpqatDe3g5ZluH3+4W8tmiFKmcgZDei8kNRFJSVlWFoaAhlZWWoqamZdRyoqoqamhp93BcXF0esfPj9fj1TZFmGoihTnuPz+aa0O1OWaNspBw4cQHFx8Zz9mw3zIzGwwDAgWr/sbrcbzz//PLKystDU1IS2trZ5fyxLVVU0NDSgtLQUiqKgsbERQ0NDACYCwefzobu7G4qioLS0FA0NDfog279/P5KTk6EoCkpKSoS8tmgVZTykRXYjKj9kWUZHRwcyMzPR0dGB+vr6GdtUVRW7du2C0+mEoihQFAV1dXXweDwRRUZrayvy8vKgKAoyMzOnPOfcuXM4ceKE/vi5suTs2bN49dVX5+zfXJgfiYEFRoLRvinQ4XAgPz8fwWAQPp8PVVVVevGSnZ2N8fFxfRBnZWVh48aNlvWZiMQaGhrC8PAwysvL9dtkWUZhYSEGBgb024qKipCZmQkAOHXqFMbHxyOeU15ejlWrVgGAoSwBgNLSUm4HEQCAX+1nwJIlS3Dp0iWoqoprr73W6u5MS5IkbN26FdXV1ZBlGUVFRdi2bZt+f2VlZcTj09PTMTY2BmDi65CjtRQpeqYQzQO3RNFgVX7MNK7Dv67c6XTqjxkdHUVKSsqcWTBTlqSlpSE1NRXLli1bcN+ZH4mBBYYBkiTh3LlzuHDhQtwWGMDEqkVbW5u+PNrc3KzPRpqamiDL8pTnjI6ORqUv0fo4WLQOfxFFi1X5MTw8DFVVp4yVjIwMw88ZGxubci5spiwR+dcxmR+JgVskBsTLZ6czMjLQ39+vD+Senh4MDg4CmBjc7e3tACYGz4YNGwBMFB25ubnw+Xx6/wOBAPbu3RvVvkbrMFW0Pr5GFC1W5EdmZiZcLhf27dun36YoCvr7+2fcDl29ejWAiVwBJvrb0tKiT0JimSXMj8TAAsOAaB4McjgcKC0tNfQpksLCQrhcLhQUFECWZZw5cwZZWVl6O8nJyRGnv7XVC4/HA6fTifz8fMiyjJaWFjz88MPCX0u4aH0cjDMQshuR+eF2u3H33XfP+SkSSZKwbds2jIyM6Jmwe/duNDY2zniQ3OFwoLa2Fs3NzZBlGfn5+bj//vv1MxhA7LKE+ZEYuEViQLRnICUlJYY+vSFJEurr61FfX6/f9thjjxlqx+PxwOPxTLldCx/Roj0DYUCQXYjOj5nG8mTT5UW46bLC7Xajs7Mz4rZNmzYZur7D4cDu3bvn7JcRzI/EwBUMA+Jli8ROoj0D4RIn2QXzwzzmR2LgCoYBy5cvBwD9UxfR5PV60draGnFbeno6vF4v3G531K8vSkpKCoCJz8WL9Pnnn0e0TxTvopkfiZIXkzE/EgMLDAOcTicA4PTp01G/ltHlz3in7fOKPFkOXA7p+f5BMqJYi2Z+JEpeTMb8SAzcIjFAC4jPPvvM4p7YR7QCQmuPAUF2wfwwj/mRGFhgGBDLFYxEoQ1gkcvC58+fx8WLFyFJEpKTk4W1SxRNzA/zmB+JgQWGAZyBmOdwOJCUlITPP/8cX331lZA2ubxJdsT8MI/5kRhYYBjAGYh5V111Fa699lqEQiFhB7W4vEl2xPwwj/mRGFhgGLBs2TIsXboUn3zyCS5dumR1d2xjxYoVAMTN3EZGRgBcPpVPZAfMj/lhftgfCwyDbr/9dly4cAHvvfee1V2xjZtvvhnAxPcbiPDRRx8BmP27FIjiEfPDPOaH/bHAMOi2224DABw7dszintiHNpD/9a9/CWlPCwgteIjsgvlhHvPD/lhgGHTHHXcAAAYGBizuiX1oA1l0QHAGQnbD/DCP+WF/LDAMWrNmDQAGhBnaQBa9xMkZCNkN88M85of9scAw6JZbbsGSJUtw6tQpftzMIJF7qJ9++inOnz+PJUuW4MYbb1xwe0SxxPwwj/lhfywwDFq8eLH+1ehvvvmmxb2xh+XLlyMtLQ3Dw8MYHR1dUFtDQ0MAJmaCSUlJIrpHFDPMD/OYH/bHAsOE7373uwCA3t5ei3tiH3feeScA4O23315QO9rhuLvuumvBfSKyAvPDPOaHvbHAMOG+++7DokWL8Oabb+LixYtWd8cWMjMzAQB9fX0Lakfbu87JyVlwn4iswPwwj/lhbywwTLjhhhuQk5OD8fFxftzMIG0GspCf18WLF/Hee+8hKSkJ2dnZorpGFFPMD/OYH/bGAsMkbZnz9ddft7gn9rB27VokJSXh/fffn/cXF33wwQf44osvsGrVKv4VPrI15oc5zA97Y4Fh0re//W1IkoTOzk58/vnnVncn7jkcDqxZswb/+9//0N/fP682/v73vwMAZFkW2TWimGN+mMP8sDcWGCatWLECBQUFCAaD6OjosLo7tqDN2rq7u+f1/FdeeQUAsGnTJmF9IrIC88M85od9scCYhx/+8IcAgPb2dpw7d87i3sS/wsJCXHXVVejr6zN9uO348eP44IMP9P1rIrtjfpjD/LAvFhjz8I1vfAO5ubk4c+YM/vjHP1rdnbj39a9/HevXr8fZs2fx1ltvmXru3/72NwCXT+AT2R3zwxzmh32xwJinRx55BADw3HPP4ZNPPrG4N/Hv+9//PgCgra3N8HPGx8fh8/kAAN/73vei0i8iKzA/zGF+2BMLjHnKz8/Hpk2bcP78eezcuROhUMjqLsW1Bx54ADfffDMOHTqEwcFBQ8/x+XwYGxtDbm4u1q1bF+UeEsUO88Mc5oc9scBYgCeffBJpaWk4cuQIWlparO5OXLv66qvx6KOPAgB++9vfzvn4sbEx/OEPfwAAVFZWRrVvRFZgfhjH/LAnFhgLcP3118Pj8QAAnn32Wezbt8/iHsW3oqIifRYy195zbW0tTp8+jdzcXH68jBIS88Mc5of9sMBYoJKSEjzxxBMAgGeeeQZNTU08GT6Dq6++GnV1dVi0aBF+85vfzHhg6+mnn8Y//vEP3Hjjjdi1a1eMe0kUO8wP45gf9nNVbW1trYiGmpqaAACPP/64iOZsJScnBzfddBPeeOMNHDp0CH/5y1+waNEiXLp0CZIkQZIkq7sYN7SvSu7r68NLL70EALjmmmuwdOlSvPPOO2hoaEBnZycAYM+ePVi1apVlfY13iTLmEuV1zBfzwzjmhxixGnNJIUGni7RlKEVRRDRnS++++y727NmDN954w+qu2Nry5cuxfft23HvvvVZ3Ja4lyphLlNexUMwPMZgfc4vVmOMHgwW6/fbbsWfPHhw5cgQvv/wyAoEAAoEAgsGg1V2Le8nJycjKyoIsy3jwwQfhcDis7hJRTDE/5o/5EZ9YYETB+vXrsX79equ7QUQ2xPygRMFDnkRERCQcCwwiIiISjgUGERERCccCg4iIiIRjgUFERETCscAgIiIi4VhgEBERkXAsMIiIiEg4FhhxxO/3w+v1AgBUVUVNTc0V/+eTiWh64XkRDAZRVVWFQCBgSV+svj7FJxYYREREJBwLDCIiIhKOBYaFFEWBLMuQZRkVFRU4c+bMlMdoWyXa4/x+/6xtBoNBVFRURGytKIqCiooK/UuTwq+rLbFOd63w+xRFQU1NDdrb2w31g4jEMpIXo6OjqKio0B9nZItVy4zwtsO/YE3bivF6vXqbk7PC5/NNadfv90/bJrPkysECwyKKomDHjh3o6OiAoiiora2ddpA+9dRT2Lx5MxRFQUdHB5qbmxd0LiMQCKCxsVG/bkFBAQKBAFRVxa5du+B0OqEoCnp7ezEyMhIx+Pfv34/k5GQoioKSkpJ594GIzDGSF2fPnsXu3bvR2NgIRVHQ1NSEHTt2zHouIhgMorq6GqWlpVAUBYqioLS0FNXV1RFFRmtrK/Ly8qAoCjIzMyOyQlEUnDt3DidOnNAf7/f74fP50N3drbfZ0NAAVVUBMEuuFCwwLHLw4EFs2bIFbrcbAOB2u7Fly5Ypj5v8mMLCQhw8eHBB1x4dHcXo6CgA4I477oDb7cbQ0BCGh4dRXl4OAJAkCRs2bMDJkyf152VlZWHjxo0LujYRmWc0L6qqqvSvKs/MzEROTg4GBgZmbLenpwculwuFhYX6bYWFhXC5XPjwww/124qKipCZmQkAOHXqFMbHx/WsAIDy8nKsWrUKwETR4vP5IvqSnZ2N8fFxvcBgllwZ+HXtFlBVFSMjI8jLy5vzsS6XK+LfGRkZEW/6ZrndbtTV1aGyshIAsH37dn0GMTg4iIKCgojHFxUV6aHgcrkgSdK8r01E5hnNi9TUVCxbtkz/tyRJcDqdc7bvdDqnHdfDw8OQZXnKY0ZHR5GSkjJnFmgZo0lPT8fY2BgAZsmVggWGhcIHMABDhcPJkyeRkZGxoOtq+6iBQAAej0cvYrKystDY2KjPOogofpjNC6OFycjICFRVnfKGP3lyM7kv4c8ZGxuL2FIBgKampoj+arTVU0p83CKxgLb94PP5Ig4+tba2Tnns7t27Ix7T1dWF7OzsWdt2uVz6NoqqqhF7tdqeKTAxo8jJyQEArF69GsDEkqnG7/fz73AQWcxoXpw9exYtLS36imNXVxeGh4f1sT2djRs3Ynh4GF1dXfpt2n9rWyKTTc4KVVXR0tKiFw4OhwO5ubnw+Xx6XwKBAPbu3Wv6tZO9scCwSElJCXJzc1FQUKCfwt66deuUx5WXl6O6uhqyLKOyshJ1dXX6Pux0JEnC5s2b0dXVBVmWUVZWhjvvvFO/PzMzEz6fD7IsIz8/H06nE7Isw+FwoLGxUb9Pm3lMNwMhotgykhepqam4//77UVZWBlmW0dzcjNra2llXJKcb9319fdi2bduMWxgOhwO1tbVobm7Wc+T+++/Xz2AAgMfjgdPpRH5+PmRZRktLCx5++GExPwyyjaRQKBQS0ZD2RsQZL1FsJMqYS5TXQWQXsRpzXMEgIiIi4XjI06a8Xu+UPdj09HR4vd5Zt1CI6Mqi/a2LwcHBiNuLiopm3QohWigWGDbl8Xjg8Xis7gYRxTmHw4G2tjaru0FXIG6REBERkXAsMIiIiEg4FhhEREQkHAsMIiIiEo4FBhEREQnHAoOIiIiEY4FBREREwrHAICIiIuFYYBAREa/2mwMAAADoSURBVJFwLDCIiIhIOBYYREREJBwLDCIiIhKOBQYREREJxwKDiIiIhBP+de2yLItukoiuAMwOosQibAUjJydHVFNEZFAijLtEeA1EdhOLcZcUCoVCUb8KERERXVF4BoOIiIiEY4FBREREwrHAICIiIuFYYBAREZFwLDCIiIhIOBYYREREJBwLDCIiIhKOBQYREREJxwKDiIiIhGOBQURERMKxwCAiIiLhWGAQERGRcCwwiIiISDgWGERERCQcCwwiIiISjgUGERERCccCg4iIiIRjgUFERETCscAgIiIi4VhgEBERkXD/BxdZdVoqk6yCAAAAAElFTkSuQmCC"},564:function(s,a,t){s.exports=t.p+"assets/img/image-20220810163534068.9e858df4.png"},565:function(s,a){s.exports="data:image/png;base64,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"},566:function(s,a,t){s.exports=t.p+"assets/img/image-20220819151154763.d36943da.png"},684:function(s,a,t){"use strict";t.r(a);var n=t(7),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"第01章-高性能架构模式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第01章-高性能架构模式"}},[s._v("#")]),s._v(" 第01章 高性能架构模式")]),s._v(" "),n("p",[s._v("互联网业务兴起之后，海量用户加上海量数据的特点，单个数据库服务器已经难以满足业务需要，必须考虑数据库集群的方式来提升性能。高性能数据库集群的"),n("code",[s._v("第一种方式是“读写分离”")]),s._v("，"),n("code",[s._v("第二种方式是“数据库分片”")]),s._v("。")]),s._v(" "),n("h3",{attrs:{id:"_1、读写分离架构"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、读写分离架构"}},[s._v("#")]),s._v(" 1、读写分离架构")]),s._v(" "),n("p",[s._v("**读写分离原理：**读写分离的基本原理是将数据库读写操作分散到不同的节点上，下面是其基本架构图：")]),s._v(" "),n("img",{attrs:{src:t(543)}}),s._v(" "),n("p",[n("strong",[s._v("读写分离的基本实现：")])]),s._v(" "),n("ul",[n("li",[n("code",[s._v("主库负责处理事务性的增删改操作，从库负责处理查询操作")]),s._v("，能够有效的避免由数据更新导致的行锁，使得整个系统的查询性能得到极大的改善。")]),s._v(" "),n("li",[s._v("读写分离是"),n("code",[s._v("根据 SQL 语义的分析")]),s._v("，"),n("code",[s._v("将读操作和写操作分别路由至主库与从库")]),s._v("。")]),s._v(" "),n("li",[s._v("通过"),n("code",[s._v("一主多从")]),s._v("的配置方式，可以将查询请求均匀的分散到多个数据副本，能够进一步的提升系统的处理能力。")]),s._v(" "),n("li",[s._v("使用"),n("code",[s._v("多主多从")]),s._v("的方式，不但能够提升系统的吞吐量，还能够提升系统的可用性，可以达到在任何一个数据库宕机，甚至磁盘物理损坏的情况下仍然不影响系统的正常运行。")])]),s._v(" "),n("p",[n("strong",[s._v("下图展示了根据业务需要，将用户表的写操作和读操路由到不同的数据库的方案：")])]),s._v(" "),n("img",{attrs:{src:t(544)}}),s._v(" "),n("p",[n("strong",[s._v("CAP 理论：")])]),s._v(" "),n("p",[s._v("CAP 定理（CAP theorem）又被称作布鲁尔定理（Brewer's theorem），是加州大学伯克利分校的计算机科学家埃里克·布鲁尔（Eric Brewer）在 2000 年的 ACM PODC 上提出的一个猜想。"),n("code",[s._v("对于设计分布式系统的架构师来说，CAP 是必须掌握的理论。")])]),s._v(" "),n("p",[s._v("在一个"),n("code",[s._v("分布式系统中")]),s._v("，当涉及读写操作时，只能保证一致性（Consistence）、可用性（Availability）、分区容错性（Partition Tolerance）三者中的两个，另外一个必须被牺牲。")]),s._v(" "),n("ul",[n("li",[s._v("C 一致性（Consistency）：对某个指定的客户端来说，读操作保证能够返回最新的写操作结果")]),s._v(" "),n("li",[s._v("A 可用性（Availability）：非故障的节点在合理的时间内返回合理的响应"),n("code",[s._v("（不是错误和超时的响应）")])]),s._v(" "),n("li",[s._v("P 分区容忍性（Partition Tolerance）：当出现网络分区后"),n("code",[s._v("（可能是丢包，也可能是连接中断，还可能是拥塞）")]),s._v("，系统能够继续“履行职责”")])]),s._v(" "),n("p",[n("strong",[s._v("CAP特点：")])]),s._v(" "),n("ul",[n("li",[n("p",[s._v("在实际设计过程中，每个系统不可能只处理一种数据，而是包含多种类型的数据，"),n("code",[s._v("有的数据必须选择 CP，有的数据必须选择 AP，分布式系统理论上不可能选择 CA 架构。")])]),s._v(" "),n("ul",[n("li",[s._v("CP：如下图所示，"),n("code",[s._v("为了保证一致性")]),s._v("，当发生分区现象后，N1 节点上的数据已经更新到 y，但由于 N1 和 N2 之间的复制通道中断，数据 y 无法同步到 N2，N2 节点上的数据还是 x。"),n("code",[s._v("这时客户端 C 访问 N2 时，N2 需要返回 Error，提示客户端 C“系统现在发生了错误”，")]),s._v("这种处理方式"),n("code",[s._v("违背了可用性")]),s._v("（Availability）的要求，因此 CAP 三者只能满足 CP。")])])])]),s._v(" "),n("img",{attrs:{src:t(545)}}),s._v(" "),n("ul",[n("li",[s._v("AP：如下图所示，"),n("code",[s._v("为了保证可用性")]),s._v("，当发生分区现象后，N1 节点上的数据已经更新到 y，但由于 N1 和 N2 之间的复制通道中断，数据 y 无法同步到 N2，N2 节点上的数据还是 x。"),n("code",[s._v("这时客户端 C 访问 N2 时，N2 将当前自己拥有的数据 x 返回给客户端 C 了")]),s._v("，而实际上当前最新的数据已经是 y 了，这就"),n("code",[s._v("不满足一致性")]),s._v("（Consistency）的要求了，因此 CAP 三者只能满足 AP。注意：这里 N2 节点返回 x，虽然不是一个“正确”的结果，但是一个“合理”的结果，因为 x 是旧的数据，并不是一个错乱的值，只是不是最新的数据而已。")])]),s._v(" "),n("img",{attrs:{src:t(546)}}),s._v(" "),n("ul",[n("li",[n("p",[s._v("CAP 理论中的 "),n("code",[s._v("C 在实践中是不可能完美实现的")]),s._v("，在数据复制的过程中，节点N1 和节点 N2 的数据并不一致（强一致性）。即使无法做到"),n("code",[s._v("强一致性")]),s._v("，但应用可以采用适合的方式达到"),n("code",[s._v("最终一致性")]),s._v("。具有如下特点：")]),s._v(" "),n("ul",[n("li",[s._v("基本可用（Basically Available）：分布式系统在出现故障时，允许损失部分可用性，即保证核心可用。")]),s._v(" "),n("li",[s._v("软状态（Soft State）：允许系统存在中间状态，而该中间状态不会影响系统整体可用性。这里的中间状态就是 CAP 理论中的数据不一致。")]),s._v(" "),n("li",[n("code",[s._v("最终一致性（Eventual Consistency）：系统中的所有数据副本经过一定时间后，最终能够达到一致的状态。")])])])])]),s._v(" "),n("h3",{attrs:{id:"_2、数据库分片架构"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、数据库分片架构"}},[s._v("#")]),s._v(" 2、数据库分片架构")]),s._v(" "),n("p",[n("strong",[s._v("读写分离的问题：")])]),s._v(" "),n("p",[s._v("读写分离分散了数据库读写操作的压力，但没有分散存储压力，为了满足业务数据存储的需求，就需要"),n("code",[s._v("将存储分散到多台数据库服务器上")]),s._v("。")]),s._v(" "),n("p",[n("strong",[s._v("数据分片：")])]),s._v(" "),n("p",[s._v("将存放在单一数据库中的数据分散地存放至多个数据库或表中，以达到提升性能瓶颈以及可用性的效果。 数据分片的有效手段是对关系型数据库进行"),n("code",[s._v("分库和分表")]),s._v("。数据分片的拆分方式又分为"),n("code",[s._v("垂直分片和水平分片")]),s._v("。")]),s._v(" "),n("h4",{attrs:{id:"_2-1、垂直分片"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-1、垂直分片"}},[s._v("#")]),s._v(" 2.1、垂直分片")]),s._v(" "),n("p",[n("strong",[s._v("垂直分库：")])]),s._v(" "),n("p",[n("code",[s._v("按照业务拆分的方式称为垂直分片，又称为纵向拆分")]),s._v("，它的核心理念是专库专用。 在拆分之前，一个数据库由多个数据表构成，每个表对应着不同的业务。而拆分之后，则是按照业务将表进行归类，分布到不同的数据库中，从而将压力分散至不同的数据库。")]),s._v(" "),n("img",{attrs:{src:t(547)}}),s._v(" "),n("p",[s._v("下图展示了根据业务需要，将用户表和订单表垂直分片到不同的数据库的方案：")]),s._v(" "),n("img",{attrs:{src:t(548)}}),s._v(" "),n("p",[s._v("垂直拆分可以缓解数据量和访问量带来的问题，但无法根治。"),n("code",[s._v("如果垂直拆分之后，表中的数据量依然超过单节点所能承载的阈值，则需要水平分片来进一步处理。")])]),s._v(" "),n("p",[n("strong",[s._v("垂直分表：")])]),s._v(" "),n("p",[n("code",[s._v("垂直分表适合将表中某些不常用的列，或者是占了大量空间的列拆分出去。")])]),s._v(" "),n("p",[s._v("假设我们是一个婚恋网站，用户在筛选其他用户的时候，主要是用 age 和 sex 两个字段进行查询，而 nickname 和 description 两个字段主要用于展示，一般不会在业务查询中用到。description 本身又比较长，因此我们可以将这两个字段独立到另外一张表中，这样在查询 age 和 sex 时，就能带来一定的性能提升。")]),s._v(" "),n("p",[s._v("垂直分表引入的复杂性主要体现在表操作的数量要增加。例如，原来只要一次查询就可以获取 name、age、sex、nickname、description，现在需要两次查询，一次查询获取 name、age、sex，另外一次查询获取 nickname、description。")]),s._v(" "),n("img",{attrs:{src:t(549)}}),s._v(" "),n("p",[n("code",[s._v("水平分表适合表行数特别大的表，水平分表属于水平分片")]),s._v("。")]),s._v(" "),n("h4",{attrs:{id:"_2-2、水平分片"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-2、水平分片"}},[s._v("#")]),s._v(" 2.2、水平分片")]),s._v(" "),n("p",[n("code",[s._v("水平分片又称为横向拆分。")]),s._v(" 相对于垂直分片，它不再将数据根据业务逻辑分类，而是通过某个字段（或某几个字段），根据某种规则将数据分散至多个库或表中，每个分片仅包含数据的一部分。 例如：根据主键分片，偶数主键的记录放入 0 库（或表），奇数主键的记录放入 1 库（或表），如下图所示。")]),s._v(" "),n("img",{attrs:{src:t(550)}}),s._v(" "),n("p",[n("code",[s._v("单表进行切分后，是否将多个表分散在不同的数据库服务器中，可以根据实际的切分效果来确定。")])]),s._v(" "),n("ul",[n("li",[n("p",[s._v("**水平分表：**单表切分为多表后，新的表即使在同一个数据库服务器中，也可能带来可观的性能提升，如果性能能够满足业务要求，可以不拆分到多台数据库服务器，毕竟业务分库也会引入很多复杂性；")])]),s._v(" "),n("li",[n("p",[s._v("**水平分库：**如果单表拆分为多表后，单台服务器依然无法满足性能要求，那就需要将多个表分散在不同的数据库服务器中。")])])]),s._v(" "),n("blockquote",[n("p",[n("strong",[s._v("阿里巴巴Java开发手册：")])]),s._v(" "),n("p",[s._v("【推荐】单表行数超过 500 万行或者单表容量超过 2GB，才推荐进行分库分表。")]),s._v(" "),n("p",[s._v("说明：如果预计三年后的数据量根本达不到这个级别，"),n("code",[s._v("请不要在创建表时就分库分表")]),s._v("。")])]),s._v(" "),n("h3",{attrs:{id:"_3、读写分离和数据分片架构"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3、读写分离和数据分片架构"}},[s._v("#")]),s._v(" 3、读写分离和数据分片架构")]),s._v(" "),n("p",[s._v("下图展现了将数据分片与读写分离一同使用时，应用程序与数据库集群之间的复杂拓扑关系。")]),s._v(" "),n("img",{attrs:{src:t(551)}}),s._v(" "),n("h3",{attrs:{id:"_4、实现方式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4、实现方式"}},[s._v("#")]),s._v(" 4、实现方式")]),s._v(" "),n("p",[s._v("读写分离和数据分片具体的实现方式一般有两种：  "),n("code",[s._v("程序代码封装")]),s._v("和"),n("code",[s._v("中间件封装")]),s._v("。")]),s._v(" "),n("h4",{attrs:{id:"_4-1、程序代码封装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-1、程序代码封装"}},[s._v("#")]),s._v(" 4.1、程序代码封装")]),s._v(" "),n("p",[s._v("程序代码封装指在代码中抽象一个"),n("code",[s._v("数据访问层（或中间层封装）")]),s._v("，实现读写操作分离和数据库服务器连接的管理。")]),s._v(" "),n("p",[s._v("**其基本架构是：**以读写分离为例")]),s._v(" "),n("img",{attrs:{src:t(552)}}),s._v(" "),n("h4",{attrs:{id:"_4-2、中间件封装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-2、中间件封装"}},[s._v("#")]),s._v(" 4.2、中间件封装")]),s._v(" "),n("p",[s._v("中间件封装指的是"),n("code",[s._v("独立一套系统出来")]),s._v("，实现读写操作分离和数据库服务器连接的管理。对于业务服务器来说，访问中间件和访问数据库没有区别，在业务服务器看来，中间件就是一个数据库服务器。")]),s._v(" "),n("p",[s._v("**基本架构是：**以读写分离为例")]),s._v(" "),n("img",{attrs:{src:t(553)}}),s._v(" "),n("h4",{attrs:{id:"_4-3、常用解决方案"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-3、常用解决方案"}},[s._v("#")]),s._v(" 4.3、常用解决方案")]),s._v(" "),n("p",[s._v("Apache ShardingSphere（程序级别和中间件级别）")]),s._v(" "),n("p",[s._v("MyCat（数据库中间件）")]),s._v(" "),n("h2",{attrs:{id:"第02章-shardingsphere"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第02章-shardingsphere"}},[s._v("#")]),s._v(" 第02章 ShardingSphere")]),s._v(" "),n("h3",{attrs:{id:"_1、简介"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、简介"}},[s._v("#")]),s._v(" 1、简介")]),s._v(" "),n("p",[s._v("官网：https://shardingsphere.apache.org/index_zh.html")]),s._v(" "),n("p",[s._v("文档：https://shardingsphere.apache.org/document/5.1.1/cn/overview/")]),s._v(" "),n("p",[s._v("Apache ShardingSphere 由 JDBC、Proxy 和 Sidecar（规划中）这 3 款既能够独立部署，又支持混合部署配合使用的产品组成。")]),s._v(" "),n("h3",{attrs:{id:"_2、shardingsphere-jdbc"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、shardingsphere-jdbc"}},[s._v("#")]),s._v(" 2、ShardingSphere-JDBC")]),s._v(" "),n("p",[n("strong",[s._v("程序代码封装")])]),s._v(" "),n("p",[s._v("定位为轻量级 Java 框架，"),n("code",[s._v("在 Java 的 JDBC 层提供的额外服务")]),s._v("。 它使用客户端直连数据库，"),n("code",[s._v("以 jar 包形式提供服务")]),s._v("，无需额外部署和依赖，可理解为增强版的 JDBC 驱动，完全兼容 JDBC 和各种 ORM 框架。")]),s._v(" "),n("img",{attrs:{src:t(554)}}),s._v(" "),n("h3",{attrs:{id:"_3、shardingsphere-proxy"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3、shardingsphere-proxy"}},[s._v("#")]),s._v(" 3、ShardingSphere-Proxy")]),s._v(" "),n("p",[n("strong",[s._v("中间件封装")])]),s._v(" "),n("p",[s._v("定位为透明化的"),n("code",[s._v("数据库代理端")]),s._v("，提供封装了数据库二进制协议的服务端版本，用于完成对异构语言的支持。 目前提供 MySQL 和 PostgreSQL版本，它可以使用任何兼容 MySQL/PostgreSQL 协议的访问客户端（如：MySQL Command Client, MySQL Workbench, Navicat 等）操作数据，对 DBA 更加友好。")]),s._v(" "),n("img",{attrs:{src:t(555)}}),s._v(" "),n("h2",{attrs:{id:"第03章-mysql主从同步"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第03章-mysql主从同步"}},[s._v("#")]),s._v(" 第03章 MySQL主从同步")]),s._v(" "),n("h3",{attrs:{id:"_1、mysql主从同步原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、mysql主从同步原理"}},[s._v("#")]),s._v(" 1、MySQL主从同步原理")]),s._v(" "),n("img",{attrs:{src:t(556)}}),s._v(" "),n("p",[n("strong",[s._v("基本原理：")])]),s._v(" "),n("p",[s._v("slave会从master读取binlog来进行数据同步")]),s._v(" "),n("p",[n("strong",[s._v("具体步骤：")])]),s._v(" "),n("ul",[n("li",[n("code",[s._v("step1：")]),s._v("master将数据改变记录到"),n("code",[s._v("二进制日志（binary log）")]),s._v("中。")]),s._v(" "),n("li",[n("code",[s._v("step2：")]),s._v(" 当slave上执行 "),n("code",[s._v("start slave")]),s._v(" 命令之后，slave会创建一个 "),n("code",[s._v("IO 线程")]),s._v("用来连接master，请求master中的binlog。")]),s._v(" "),n("li",[n("code",[s._v("step3：")]),s._v("当slave连接master时，master会创建一个 "),n("code",[s._v("log dump 线程")]),s._v("，用于发送 binlog 的内容。在读取 binlog 的内容的操作中，会对主节点上的 binlog 加锁，当读取完成并发送给从服务器后解锁。")]),s._v(" "),n("li",[n("code",[s._v("step4：")]),s._v("IO 线程接收主节点 binlog dump 进程发来的更新之后，保存到 "),n("code",[s._v("中继日志（relay log）")]),s._v(" 中。")]),s._v(" "),n("li",[n("code",[s._v("step5：")]),s._v("slave的"),n("code",[s._v("SQL线程")]),s._v("，读取relay log日志，并解析成具体操作，从而实现主从操作一致，最终数据一致。")])]),s._v(" "),n("h3",{attrs:{id:"_2、一主多从配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、一主多从配置"}},[s._v("#")]),s._v(" 2、一主多从配置")]),s._v(" "),n("p",[s._v("服务器规划：使用"),n("code",[s._v("docker")]),s._v("方式创建，"),n("code",[s._v("主从服务器IP一致，端口号不一致")])]),s._v(" "),n("img",{attrs:{src:t(557)}}),s._v(" "),n("ul",[n("li",[s._v("主服务器：容器名"),n("code",[s._v("atguigu-mysql-master")]),s._v("，端口"),n("code",[s._v("3306")])]),s._v(" "),n("li",[s._v("从服务器：容器名"),n("code",[s._v("atguigu-mysql-slave1")]),s._v("，端口"),n("code",[s._v("3307")])]),s._v(" "),n("li",[s._v("从服务器：容器名"),n("code",[s._v("atguigu-mysql-slave2")]),s._v("，端口"),n("code",[s._v("3308")])])]),s._v(" "),n("p",[s._v("**注意：**如果此时防火墙是开启的，"),n("code",[s._v("则先关闭防火墙，并重启docker")]),s._v("，否则后续安装的MySQL无法启动")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#关闭docker")]),s._v("\nsystemctl stop docker\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#关闭防火墙")]),s._v("\nsystemctl stop firewalld\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动docker")]),s._v("\nsystemctl start docker\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h4",{attrs:{id:"_2-1、准备主服务器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-1、准备主服务器"}},[s._v("#")]),s._v(" 2.1、准备主服务器")]),s._v(" "),n("ul",[n("li",[n("strong",[s._v("step1：在docker中创建并启动MySQL主服务器：")]),n("code",[s._v("端口3306")])])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker run -d "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(":3306 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /atguigu/mysql/master/conf:/etc/mysql/conf.d "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /atguigu/mysql/master/data:/var/lib/mysql "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-e "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--name atguigu-mysql-master "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\nmysql:8.0.29\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("ul",[n("li",[n("strong",[s._v("step2：创建MySQL主服务器配置文件：")])])]),s._v(" "),n("p",[s._v("默认情况下MySQL的binlog日志是自动开启的，可以通过如下配置定义一些可选配置")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /atguigu/mysql/master/conf/my.cnf\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("配置如下内容")]),s._v(" "),n("div",{staticClass:"language-properties line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[s._v("[mysqld]\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 服务器唯一id，默认值1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("server-id")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置日志格式，默认值ROW")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("binlog_format")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("STATEMENT")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 二进制日志名，默认binlog")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# log-bin=binlog")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置需要复制的数据库，默认复制全部数据库")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#binlog-do-db=mytestdb")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置不需要复制的数据库")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#binlog-ignore-db=mysql")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#binlog-ignore-db=infomation_schema")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("p",[s._v("重启MySQL容器")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker restart atguigu-mysql-master\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("code",[s._v("binlog格式说明：")])]),s._v(" "),n("ul",[n("li",[s._v("binlog_format=STATEMENT：日志记录的是主机数据库的"),n("code",[s._v("写指令")]),s._v("，性能高，但是now()之类的函数以及获取系统参数的操作会出现主从数据不同步的问题。")]),s._v(" "),n("li",[s._v("binlog_format=ROW（默认）：日志记录的是主机数据库的"),n("code",[s._v("写后的数据")]),s._v("，批量操作时性能较差，解决now()或者  user()或者  @@hostname 等操作在主从机器上不一致的问题。")]),s._v(" "),n("li",[s._v("binlog_format=MIXED：是以上两种level的混合使用，有函数用ROW，没函数用STATEMENT，但是无法识别系统变量")])]),s._v(" "),n("p",[n("code",[s._v("binlog-ignore-db和binlog-do-db的优先级问题：")])]),s._v(" "),n("img",{attrs:{src:t(558)}}),s._v(" "),n("ul",[n("li",[n("strong",[s._v("step3：使用命令行登录MySQL主服务器：")])])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入容器：env LANG=C.UTF-8 避免容器中显示中文乱码")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it atguigu-mysql-master "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("env")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("LANG")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("C.UTF-8 /bin/bash\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入容器内的mysql命令行")]),s._v("\nmysql -uroot -p\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改默认密码校验方式")]),s._v("\nALTER "),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v("@"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),s._v(" IDENTIFIED WITH mysql_native_password BY "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("ul",[n("li",[n("strong",[s._v("step4：主机中创建slave用户：")])])]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 创建slave用户")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USER")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'atguigu_slave'")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@'%'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 设置密码")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USER")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'atguigu_slave'")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@'%'")]),s._v(" IDENTIFIED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" mysql_native_password "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 授予复制权限")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GRANT")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("REPLICATION")]),s._v(" SLAVE "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'atguigu_slave'")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@'%'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 刷新权限")]),s._v("\nFLUSH "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIVILEGES")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("ul",[n("li",[n("strong",[s._v("step5：主机中查询master状态：")])])]),s._v(" "),n("p",[s._v("执行完此步骤后"),n("code",[s._v("不要再操作主服务器MYSQL")]),s._v("，防止主服务器状态值变化")]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" MASTER "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("STATUS")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("记下"),n("code",[s._v("File")]),s._v("和"),n("code",[s._v("Position")]),s._v("的值。执行完此步骤后不要再操作主服务器MYSQL，防止主服务器状态值变化。")]),s._v(" "),n("img",{attrs:{src:t(559)}}),s._v(" "),n("h4",{attrs:{id:"_2-2、准备从服务器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-2、准备从服务器"}},[s._v("#")]),s._v(" 2.2、准备从服务器")]),s._v(" "),n("p",[s._v("可以配置多台从机slave1、slave2...，这里以配置slave1为例")]),s._v(" "),n("ul",[n("li",[n("strong",[s._v("step1：在docker中创建并启动MySQL从服务器：")]),n("code",[s._v("端口3307")])])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker run -d "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3307")]),s._v(":3306 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /atguigu/mysql/slave1/conf:/etc/mysql/conf.d "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /atguigu/mysql/slave1/data:/var/lib/mysql "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-e "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--name atguigu-mysql-slave1 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\nmysql:8.0.29\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("ul",[n("li",[n("strong",[s._v("step2：创建MySQL从服务器配置文件：")])])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /atguigu/mysql/slave1/conf/my.cnf\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("配置如下内容：")]),s._v(" "),n("div",{staticClass:"language-properties line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[s._v("[mysqld]\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 服务器唯一id，每台服务器的id必须不同，如果配置其他从机，注意修改id")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("server-id")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("2")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 中继日志名，默认xxxxxxxxxxxx-relay-bin")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#relay-log=relay-bin")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("重启MySQL容器")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker restart atguigu-mysql-slave1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ul",[n("li",[n("strong",[s._v("step3：使用命令行登录MySQL从服务器：")])])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入容器：")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it atguigu-mysql-slave1 "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("env")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("LANG")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("C.UTF-8 /bin/bash\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入容器内的mysql命令行")]),s._v("\nmysql -uroot -p\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改默认密码校验方式")]),s._v("\nALTER "),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v("@"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),s._v(" IDENTIFIED WITH mysql_native_password BY "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("ul",[n("li",[n("strong",[s._v("step4：在从机上配置主从关系：")])])]),s._v(" "),n("p",[s._v("在"),n("strong",[s._v("从机")]),s._v("上执行以下SQL操作")]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[s._v("CHANGE MASTER "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" MASTER_HOST"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'192.168.100.201'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \nMASTER_USER"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'atguigu_slave'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("MASTER_PASSWORD"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" MASTER_PORT"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\nMASTER_LOG_FILE"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'binlog.000003'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("MASTER_LOG_POS"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1357")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h4",{attrs:{id:"_2-3、启动主从同步"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-3、启动主从同步"}},[s._v("#")]),s._v(" 2.3、启动主从同步")]),s._v(" "),n("p",[s._v("启动从机的复制功能，执行SQL：")]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("START")]),s._v(" SLAVE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 查看状态（不需要分号）")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" SLAVE "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("STATUS")]),s._v("\\G\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("**两个关键进程：**下面两个参数都是Yes，则说明主从配置成功！")]),s._v(" "),n("img",{attrs:{src:t(560)}}),s._v(" "),n("h4",{attrs:{id:"_2-4、实现主从同步"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-4、实现主从同步"}},[s._v("#")]),s._v(" 2.4、实现主从同步")]),s._v(" "),n("p",[s._v("在主机中执行以下SQL，在从机中查看数据库、表和数据是否已经被同步")]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DATABASE")]),s._v(" db_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USE")]),s._v(" db_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" t_user "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BIGINT")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AUTO_INCREMENT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n uname "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" t_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("uname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VALUES")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'zhang3'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" t_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("uname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VALUES")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("@"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@hostname")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h4",{attrs:{id:"_2-5、停止和重置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-5、停止和重置"}},[s._v("#")]),s._v(" 2.5、停止和重置")]),s._v(" "),n("p",[s._v("需要的时候，可以使用如下SQL语句")]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 在从机上执行。功能说明：停止I/O 线程和SQL线程的操作。")]),s._v("\nstop slave"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 在从机上执行。功能说明：用于删除SLAVE数据库的relaylog日志文件，并重新启用新的relaylog文件。")]),s._v("\nreset slave"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 在主机上执行。功能说明：删除所有的binglog日志文件，并将日志索引文件清空，重新开始所有新的日志文件。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 用于第一次进行搭建主从库时，进行主库binlog初始化工作；")]),s._v("\nreset master"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h4",{attrs:{id:"_2-6、常见问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-6、常见问题"}},[s._v("#")]),s._v(" "),n("strong",[s._v("2.6、常见问题")])]),s._v(" "),n("h5",{attrs:{id:"问题1"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#问题1"}},[s._v("#")]),s._v(" 问题1")]),s._v(" "),n("p",[s._v("启动主从同步后，常见错误是"),n("code",[s._v("Slave_IO_Running： No 或者 Connecting")]),s._v(" 的情况，此时查看下方的 "),n("code",[s._v("Last_IO_ERROR")]),s._v("错误日志，根据日志中显示的错误信息在网上搜索解决方案即可")]),s._v(" "),n("img",{attrs:{src:t(561)}}),s._v(" "),n("p",[n("strong",[s._v("典型的错误例如：")]),n("code",[s._v("Last_IO_Error: Got fatal error 1236 from master when reading data from binary log: 'Client requested master to start replication from position > file size'")])]),s._v(" "),n("p",[n("strong",[s._v("解决方案：")])]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 在从机停止slave")]),s._v("\nSLAVE STOP"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 在主机查看mater状态")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" MASTER "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("STATUS")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 在主机刷新日志")]),s._v("\nFLUSH LOGS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 再次在主机查看mater状态（会发现File和Position发生了变化）")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" MASTER "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("STATUS")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 修改从机连接主机的SQL，并重新连接即可")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h5",{attrs:{id:"问题2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#问题2"}},[s._v("#")]),s._v(" 问题2")]),s._v(" "),n("p",[s._v("启动docker容器后提示 "),n("code",[s._v("WARNING: IPv4 forwarding is disabled. Networking will not work.")])]),s._v(" "),n("img",{attrs:{src:t(562)}}),s._v(" "),n("p",[s._v("此错误，虽然不影响主从同步的搭建，但是如果想从远程客户端通过以下方式连接docker中的MySQL则没法连接")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("C:"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("administrator"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("mysql -h "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".100.201 -P "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(" -u root -p\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("strong",[s._v("解决方案：")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改配置文件：")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /usr/lib/sysctl.d/00-system.conf\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#追加")]),s._v("\nnet.ipv4.ip_forward"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#接着重启网络")]),s._v("\nsystemctl restart network\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h2",{attrs:{id:"第04章-shardingsphere-jdbc读写分离"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第04章-shardingsphere-jdbc读写分离"}},[s._v("#")]),s._v(" 第04章 ShardingSphere-JDBC读写分离")]),s._v(" "),n("h3",{attrs:{id:"_1、创建springboot程序"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、创建springboot程序"}},[s._v("#")]),s._v(" 1、创建SpringBoot程序")]),s._v(" "),n("h4",{attrs:{id:"_1-1、创建项目"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-1、创建项目"}},[s._v("#")]),s._v(" 1.1、创建项目")]),s._v(" "),n("p",[s._v("项目类型：Spring Initializr")]),s._v(" "),n("p",[s._v("SpringBoot脚手架：http://start.aliyun.com")]),s._v(" "),n("p",[s._v("项目名：sharding-jdbc-demo")]),s._v(" "),n("p",[s._v("SpringBoot版本：2.3.7.RELEASE")]),s._v(" "),n("h4",{attrs:{id:"_1-2、添加依赖"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2、添加依赖"}},[s._v("#")]),s._v(" 1.2、添加依赖")]),s._v(" "),n("div",{staticClass:"language-xml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-xml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependencies")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.springframework.boot"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("spring-boot-starter-web"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.apache.shardingsphere"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("shardingsphere-jdbc-core-spring-boot-starter"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("5.1.1"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("mysql"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("mysql-connector-java"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("scope")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("runtime"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("scope")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("com.baomidou"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("mybatis-plus-boot-starter"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("3.3.1"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.projectlombok"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("lombok"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("optional")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("true"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("optional")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    \n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.springframework.boot"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("spring-boot-starter-test"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("scope")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("test"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("scope")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("exclusions")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("exclusion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.junit.vintage"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("junit-vintage-engine"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("exclusion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("exclusions")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependencies")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br")])]),n("h4",{attrs:{id:"_1-3、创建实体类"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-3、创建实体类"}},[s._v("#")]),s._v(" 1.3、创建实体类")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("atguigu"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("shardingjdbcdemo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("entity")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@TableName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"t_user"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Data")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@TableId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IdType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("AUTO"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" uname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h4",{attrs:{id:"_1-4、创建mapper"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-4、创建mapper"}},[s._v("#")]),s._v(" 1.4、创建Mapper")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("atguigu"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("shardingjdbcdemo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("mapper")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Mapper")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UserMapper")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BaseMapper")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h4",{attrs:{id:"_1-5、配置读写分离"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-5、配置读写分离"}},[s._v("#")]),s._v(" 1.5、配置读写分离")]),s._v(" "),n("p",[s._v("application.properties：")]),s._v(" "),n("div",{staticClass:"language-properties line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 应用名称")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.application.name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("sharging-jdbc-demo")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开发环境设置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.profiles.active")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("dev")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 内存模式")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.mode.type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("Memory")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置真实数据源")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.names")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("master,slave1,slave2")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置第 1 个数据源")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.master.type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("com.zaxxer.hikari.HikariDataSource")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.master.driver-class-name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("com.mysql.jdbc.Driver")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.master.jdbc-url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("jdbc:mysql://192.168.100.201:3306/db_user")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.master.username")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("root")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.master.password")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("123456")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置第 2 个数据源")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.slave1.type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("com.zaxxer.hikari.HikariDataSource")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.slave1.driver-class-name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("com.mysql.jdbc.Driver")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.slave1.jdbc-url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("jdbc:mysql://192.168.100.201:3307/db_user")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.slave1.username")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("root")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.slave1.password")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("123456")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置第 3 个数据源")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.slave2.type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("com.zaxxer.hikari.HikariDataSource")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.slave2.driver-class-name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("com.mysql.jdbc.Driver")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.slave2.jdbc-url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("jdbc:mysql://192.168.100.201:3308/db_user")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.slave2.username")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("root")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.slave2.password")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("123456")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 读写分离类型，如: Static，Dynamic")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.readwrite-splitting.data-sources.myds.type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("Static")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 写数据源名称")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.readwrite-splitting.data-sources.myds.props.write-data-source-name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("master")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 读数据源名称，多个从数据源用逗号分隔")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.readwrite-splitting.data-sources.myds.props.read-data-source-names")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("slave1,slave2")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 负载均衡算法名称")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.readwrite-splitting.data-sources.myds.load-balancer-name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("alg_round")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 负载均衡算法配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 负载均衡算法类型")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.readwrite-splitting.load-balancers.alg_round.type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("ROUND_ROBIN")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.readwrite-splitting.load-balancers.alg_random.type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("RANDOM")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.readwrite-splitting.load-balancers.alg_weight.type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("WEIGHT")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.readwrite-splitting.load-balancers.alg_weight.props.slave1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.readwrite-splitting.load-balancers.alg_weight.props.slave2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("2")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印SQl")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.props.sql-show")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("true")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br")])]),n("h3",{attrs:{id:"_2、测试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、测试"}},[s._v("#")]),s._v(" 2、测试")]),s._v(" "),n("h4",{attrs:{id:"_2-1、读写分离测试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-1、读写分离测试"}},[s._v("#")]),s._v(" 2.1、读写分离测试")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("atguigu"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("shardingjdbcdemo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@SpringBootTest")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ReadwriteTest")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UserMapper")]),s._v(" userMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 写入数据的测试\n     */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Test")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("testInsert")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),s._v(" user "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setUname")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"张三丰"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        userMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("insert")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])]),n("h4",{attrs:{id:"_2-2、事务测试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-2、事务测试"}},[s._v("#")]),s._v(" 2.2、事务测试")]),s._v(" "),n("p",[s._v("为了保证主从库间的事务一致性，避免跨服务的分布式事务，ShardingSphere-JDBC的"),n("code",[s._v("主从模型中，事务中的数据读写均用主库")]),s._v("。")]),s._v(" "),n("ul",[n("li",[s._v("不添加@Transactional：insert对主库操作，select对从库操作")]),s._v(" "),n("li",[s._v("添加@Transactional：则insert和select均对主库操作")]),s._v(" "),n("li",[s._v("**注意：**在JUnit环境下的@Transactional注解，默认情况下就会对事务进行回滚（即使在没加注解@Rollback，也会对事务回滚）")])]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 事务测试\n     */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Transactional")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//开启事务")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Test")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("testTrans")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),s._v(" user "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setUname")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"铁锤"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    userMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("insert")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" users "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" userMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("selectList")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("h4",{attrs:{id:"_2-3、负载均衡测试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-3、负载均衡测试"}},[s._v("#")]),s._v(" 2.3、负载均衡测试")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 读数据测试\n     */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Test")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("testSelectAll")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" users "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" userMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("selectList")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" users "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" userMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("selectList")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//执行第二次测试负载均衡")]),s._v("\n    users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v("也可以在web请求中测试负载均衡")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("atguigu"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("shardingjdbcdemo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("controller")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RestController")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RequestMapping")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/userController"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UserController")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UserMapper")]),s._v(" userMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 测试负载均衡策略\n     */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"selectAll"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("selectAll")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" users "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" userMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("selectList")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("h2",{attrs:{id:"第05章-shardingsphere-jdbc垂直分片"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第05章-shardingsphere-jdbc垂直分片"}},[s._v("#")]),s._v(" 第05章 ShardingSphere-JDBC垂直分片")]),s._v(" "),n("h3",{attrs:{id:"_1、准备服务器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、准备服务器"}},[s._v("#")]),s._v(" 1、准备服务器")]),s._v(" "),n("p",[s._v("服务器规划：使用"),n("code",[s._v("docker")]),s._v("方式创建如下容器")]),s._v(" "),n("img",{attrs:{src:t(563)}}),s._v(" "),n("ul",[n("li",[n("p",[s._v("服务器：容器名"),n("code",[s._v("server-user")]),s._v("，端口"),n("code",[s._v("3301")])])]),s._v(" "),n("li",[n("p",[s._v("服务器：容器名"),n("code",[s._v("server-order")]),s._v("，端口"),n("code",[s._v("3302")])])])]),s._v(" "),n("h4",{attrs:{id:"_1-1、创建server-user容器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-1、创建server-user容器"}},[s._v("#")]),s._v(" 1.1、创建server-user容器")]),s._v(" "),n("ul",[n("li",[n("strong",[s._v("step1：创建容器：")])])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker run -d "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3301")]),s._v(":3306 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /atguigu/server/user/conf:/etc/mysql/conf.d "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /atguigu/server/user/data:/var/lib/mysql "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-e "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--name server-user "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\nmysql:8.0.29\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("ul",[n("li",[n("strong",[s._v("step2：登录MySQL服务器：")])])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入容器：")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it server-user "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("env")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("LANG")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("C.UTF-8 /bin/bash\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入容器内的mysql命令行")]),s._v("\nmysql -uroot -p\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改默认密码插件")]),s._v("\nALTER "),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v("@"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),s._v(" IDENTIFIED WITH mysql_native_password BY "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("ul",[n("li",[n("strong",[s._v("step3：创建数据库：")])])]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DATABASE")]),s._v(" db_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USE")]),s._v(" db_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" t_user "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BIGINT")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AUTO_INCREMENT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n uname "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h4",{attrs:{id:"_1-2、创建server-order容器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2、创建server-order容器"}},[s._v("#")]),s._v(" 1.2、创建server-order容器")]),s._v(" "),n("ul",[n("li",[n("strong",[s._v("step1：创建容器：")])])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker run -d "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3302")]),s._v(":3306 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /atguigu/server/order/conf:/etc/mysql/conf.d "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /atguigu/server/order/data:/var/lib/mysql "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-e "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--name server-order "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\nmysql:8.0.29\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("ul",[n("li",[n("strong",[s._v("step2：登录MySQL服务器：")])])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入容器：")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it server-order "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("env")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("LANG")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("C.UTF-8 /bin/bash\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入容器内的mysql命令行")]),s._v("\nmysql -uroot -p\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改默认密码插件")]),s._v("\nALTER "),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v("@"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),s._v(" IDENTIFIED WITH mysql_native_password BY "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("ul",[n("li",[n("strong",[s._v("step3：创建数据库：")])])]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DATABASE")]),s._v(" db_order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USE")]),s._v(" db_order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" t_order "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BIGINT")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AUTO_INCREMENT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  order_no "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BIGINT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DECIMAL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h3",{attrs:{id:"_2、程序实现"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、程序实现"}},[s._v("#")]),s._v(" 2、程序实现")]),s._v(" "),n("h4",{attrs:{id:"_2-1、创建实体类"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-1、创建实体类"}},[s._v("#")]),s._v(" 2.1、创建实体类")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("atguigu"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("shardingjdbcdemo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("entity")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@TableName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"t_order"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Data")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@TableId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IdType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("AUTO"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" orderNo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" userId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BigDecimal")]),s._v(" amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("h4",{attrs:{id:"_2-2、创建mapper"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-2、创建mapper"}},[s._v("#")]),s._v(" 2.2、创建Mapper")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("atguigu"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("shardingjdbcdemo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("mapper")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Mapper")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OrderMapper")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BaseMapper")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h4",{attrs:{id:"_2-3、配置垂直分片"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-3、配置垂直分片"}},[s._v("#")]),s._v(" 2.3、配置垂直分片")]),s._v(" "),n("div",{staticClass:"language-properties line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 应用名称")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.application.name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("sharding-jdbc-demo")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 环境设置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.profiles.active")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("dev")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置真实数据源")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.names")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("server-user,server-order")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置第 1 个数据源")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.server-user.type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("com.zaxxer.hikari.HikariDataSource")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.server-user.driver-class-name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("com.mysql.jdbc.Driver")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.server-user.jdbc-url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("jdbc:mysql://192.168.100.201:3301/db_user")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.server-user.username")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("root")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.server-user.password")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("123456")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置第 2 个数据源")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.server-order.type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("com.zaxxer.hikari.HikariDataSource")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.server-order.driver-class-name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("com.mysql.jdbc.Driver")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.server-order.jdbc-url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("jdbc:mysql://192.168.100.201:3302/db_order")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.server-order.username")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("root")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.server-order.password")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("123456")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 标准分片表配置（数据节点）")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# spring.shardingsphere.rules.sharding.tables.<table-name>.actual-data-nodes=值")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 值由数据源名 + 表名组成，以小数点分隔。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# <table-name>：逻辑表名")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.tables.t_user.actual-data-nodes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("server-user.t_user")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.tables.t_order.actual-data-nodes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("server-order.t_order")]),s._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印SQL")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.props.sql-show")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("true")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br")])]),n("h3",{attrs:{id:"_3、测试垂直分片"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3、测试垂直分片"}},[s._v("#")]),s._v(" 3、测试垂直分片")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("atguigu"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("shardingjdbcdemo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@SpringBootTest")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ShardingTest")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UserMapper")]),s._v(" userMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OrderMapper")]),s._v(" orderMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 垂直分片：插入数据测试\n     */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Test")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("testInsertOrderAndUser")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),s._v(" user "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setUname")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"强哥"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        userMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("insert")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),s._v(" order "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setOrderNo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ATGUIGU001"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setUserId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setAmount")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BigDecimal")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        orderMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("insert")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 垂直分片：查询数据测试\n     */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Test")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("testSelectFromOrderAndUser")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),s._v(" user "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" userMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("selectById")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1L")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),s._v(" order "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" orderMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("selectById")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1L")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br")])]),n("h4",{attrs:{id:"常见错误"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#常见错误"}},[s._v("#")]),s._v(" 常见错误")]),s._v(" "),n("img",{attrs:{src:t(564)}}),s._v(" "),n("p",[s._v("ShardingSphere-JDBC远程连接的方式默认的密码加密规则是：mysql_native_password")]),s._v(" "),n("p",[s._v("因此需要在服务器端修改服务器的密码加密规则，如下：")]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USER")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@'%'")]),s._v(" IDENTIFIED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" mysql_native_password "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"第06章-shardingsphere-jdbc水平分片"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第06章-shardingsphere-jdbc水平分片"}},[s._v("#")]),s._v(" 第06章 ShardingSphere-JDBC水平分片")]),s._v(" "),n("h3",{attrs:{id:"_1、准备服务器-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、准备服务器-2"}},[s._v("#")]),s._v(" 1、准备服务器")]),s._v(" "),n("p",[s._v("服务器规划：使用"),n("code",[s._v("docker")]),s._v("方式创建如下容器")]),s._v(" "),n("img",{attrs:{src:t(565)}}),s._v(" "),n("ul",[n("li",[n("p",[s._v("服务器：容器名"),n("code",[s._v("server-order0")]),s._v("，端口"),n("code",[s._v("3310")])])]),s._v(" "),n("li",[n("p",[s._v("服务器：容器名"),n("code",[s._v("server-order1")]),s._v("，端口"),n("code",[s._v("3311")])])])]),s._v(" "),n("h4",{attrs:{id:"_1-1、创建server-order0容器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-1、创建server-order0容器"}},[s._v("#")]),s._v(" 1.1、创建server-order0容器")]),s._v(" "),n("ul",[n("li",[n("strong",[s._v("step1：创建容器：")])])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker run -d "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3310")]),s._v(":3306 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /atguigu/server/order0/conf:/etc/mysql/conf.d "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /atguigu/server/order0/data:/var/lib/mysql "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-e "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--name server-order0 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\nmysql:8.0.29\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("ul",[n("li",[n("strong",[s._v("step2：登录MySQL服务器：")])])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入容器：")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it server-order0 "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("env")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("LANG")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("C.UTF-8 /bin/bash\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入容器内的mysql命令行")]),s._v("\nmysql -uroot -p\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改默认密码插件")]),s._v("\nALTER "),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v("@"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),s._v(" IDENTIFIED WITH mysql_native_password BY "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("ul",[n("li",[n("strong",[s._v("step3：创建数据库：")])])]),s._v(" "),n("p",[n("code",[s._v("注意：")]),s._v("水平分片的id需要在业务层实现，"),n("code",[s._v("不能依赖数据库的主键自增")])]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DATABASE")]),s._v(" db_order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USE")]),s._v(" db_order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" t_order0 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BIGINT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  order_no "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BIGINT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DECIMAL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" t_order1 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BIGINT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  order_no "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BIGINT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DECIMAL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("h4",{attrs:{id:"_1-2、创建server-order1容器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2、创建server-order1容器"}},[s._v("#")]),s._v(" 1.2、创建server-order1容器")]),s._v(" "),n("ul",[n("li",[n("strong",[s._v("step1：创建容器：")])])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker run -d "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3311")]),s._v(":3306 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /atguigu/server/order1/conf:/etc/mysql/conf.d "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /atguigu/server/order1/data:/var/lib/mysql "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-e "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--name server-order1 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\nmysql:8.0.29\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("ul",[n("li",[n("strong",[s._v("step2：登录MySQL服务器：")])])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入容器：")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it server-order1 "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("env")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("LANG")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("C.UTF-8 /bin/bash\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入容器内的mysql命令行")]),s._v("\nmysql -uroot -p\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改默认密码插件")]),s._v("\nALTER "),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v("@"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),s._v(" IDENTIFIED WITH mysql_native_password BY "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("ul",[n("li",[s._v("**step3：创建数据库：**和server-order0相同")])]),s._v(" "),n("p",[n("code",[s._v("注意：")]),s._v("水平分片的id需要在业务层实现，不能依赖数据库的主键自增")]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DATABASE")]),s._v(" db_order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USE")]),s._v(" db_order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" t_order0 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BIGINT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  order_no "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BIGINT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DECIMAL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" t_order1 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BIGINT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  order_no "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BIGINT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  amount "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DECIMAL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("h3",{attrs:{id:"_2、基本水平分片"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、基本水平分片"}},[s._v("#")]),s._v(" 2、基本水平分片")]),s._v(" "),n("h4",{attrs:{id:"_2-1、基本配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-1、基本配置"}},[s._v("#")]),s._v(" 2.1、基本配置")]),s._v(" "),n("div",{staticClass:"language-properties line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#========================基本配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 应用名称")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.application.name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("sharging-jdbc-demo")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开发环境设置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.profiles.active")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("dev")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 内存模式")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.mode.type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("Memory")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印SQl")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.props.sql-show")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("true")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h4",{attrs:{id:"_2-2、数据源配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-2、数据源配置"}},[s._v("#")]),s._v(" 2.2、数据源配置")]),s._v(" "),n("div",{staticClass:"language-properties line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#========================数据源配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置真实数据源")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.names")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("server-user,server-order0,server-order1")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置第 1 个数据源")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.server-user.type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("com.zaxxer.hikari.HikariDataSource")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.server-user.driver-class-name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("com.mysql.jdbc.Driver")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.server-user.jdbc-url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("jdbc:mysql://192.168.100.201:3301/db_user")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.server-user.username")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("root")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.server-user.password")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("123456")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置第 2 个数据源")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.server-order.type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("com.zaxxer.hikari.HikariDataSource")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.server-order.driver-class-name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("com.mysql.jdbc.Driver")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.server-order.jdbc-url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("jdbc:mysql://192.168.100.201:3310/db_order")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.server-order.username")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("root")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.server-order.password")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("123456")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置第 3 个数据源")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.server-order.type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("com.zaxxer.hikari.HikariDataSource")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.server-order.driver-class-name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("com.mysql.jdbc.Driver")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.server-order.jdbc-url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("jdbc:mysql://192.168.100.201:3311/db_order")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.server-order.username")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("root")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.datasource.server-order.password")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("123456")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br")])]),n("h4",{attrs:{id:"_2-3、标椎分片表配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-3、标椎分片表配置"}},[s._v("#")]),s._v(" 2.3、标椎分片表配置")]),s._v(" "),n("div",{staticClass:"language-properties line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#========================标准分片表配置（数据节点配置）")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# spring.shardingsphere.rules.sharding.tables.<table-name>.actual-data-nodes=值")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 值由数据源名 + 表名组成，以小数点分隔。多个表以逗号分隔，支持 inline 表达式。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# <table-name>：逻辑表名")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.tables.t_user.actual-data-nodes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("server-user.t_user")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.tables.t_order.actual-data-nodes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("server-order0.t_order0,server-order0.t_order1,server-order1.t_order0,server-order1.t_order1")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("修改Order实体类的主键策略：")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//@TableId(type = IdType.AUTO)//依赖数据库的主键自增策略")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@TableId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IdType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ASSIGN_ID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//分布式id")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("测试：保留上面配置中的一个分片表节点分别进行测试，检查每个分片节点是否可用")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 水平分片：插入数据测试\n     */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Test")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("testInsertOrder")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),s._v(" order "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setOrderNo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ATGUIGU001"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setUserId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1L")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setAmount")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BigDecimal")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    orderMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("insert")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h4",{attrs:{id:"_2-4、行表达式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-4、行表达式"}},[s._v("#")]),s._v(" 2.4、行表达式")]),s._v(" "),n("p",[s._v("优化上一步的分片表配置")]),s._v(" "),n("p",[s._v("https://shardingsphere.apache.org/document/5.1.1/cn/features/sharding/concept/inline-expression/")]),s._v(" "),n("div",{staticClass:"language-properties line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#========================标准分片表配置（数据节点配置）")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# spring.shardingsphere.rules.sharding.tables.<table-name>.actual-data-nodes=值")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 值由数据源名 + 表名组成，以小数点分隔。多个表以逗号分隔，支持 inline 表达式。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# <table-name>：逻辑表名")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.tables.t_user.actual-data-nodes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("server-user.t_user")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.tables.t_order.actual-data-nodes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("server-order$->{0..1}.t_order$->{0..1}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h4",{attrs:{id:"_2-5、分片算法配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-5、分片算法配置"}},[s._v("#")]),s._v(" 2.5、分片算法配置")]),s._v(" "),n("p",[n("strong",[s._v("水平分库：")])]),s._v(" "),n("p",[s._v("分片规则：order表中"),n("code",[s._v("user_id")]),s._v("为偶数时，数据插入"),n("code",[s._v("server-order0服务器")]),s._v("，"),n("code",[s._v("user_id")]),s._v("为奇数时，数据插入"),n("code",[s._v("server-order1服务器")]),s._v("。这样分片的好处是，同一个用户的订单数据，一定会被插入到同一台服务器上，查询一个用户的订单时效率较高。")]),s._v(" "),n("div",{staticClass:"language-properties line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#------------------------分库策略")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分片列名称")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.tables.t_order.database-strategy.standard.sharding-column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("user_id")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分片算法名称")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.tables.t_order.database-strategy.standard.sharding-algorithm-name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("alg_inline_userid")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#------------------------分片算法配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 行表达式分片算法")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分片算法类型")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.sharding-algorithms.alg_inline_userid.type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("INLINE")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分片算法属性配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.sharding-algorithms.alg_inline_userid.props.algorithm-expression")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("server-order$->{user_id % 2}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 取模分片算法")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分片算法类型")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.sharding-algorithms.alg_mod.type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("MOD")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分片算法属性配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.sharding-algorithms.alg_mod.props.sharding-count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("2")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("p",[s._v("为了方便测试，先设置只在 "),n("code",[s._v("t_order0")]),s._v("表上进行测试")]),s._v(" "),n("div",{staticClass:"language-properties line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("xxx.actual-data-nodes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("server-order$->{0..1}.t_order0")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("测试：可以分别测试行表达式分片算法和取模分片算法")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 水平分片：分库插入数据测试\n     */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Test")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("testInsertOrderDatabaseStrategy")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("long")]),s._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),s._v(" order "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setOrderNo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ATGUIGU001"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setUserId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setAmount")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BigDecimal")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        orderMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("insert")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("p",[n("strong",[s._v("水平分表：")])]),s._v(" "),n("p",[s._v("分片规则：order表中"),n("code",[s._v("order_no的哈希值为偶数时")]),s._v("，数据插入对应服务器的"),n("code",[s._v("t_order0表")]),s._v("，"),n("code",[s._v("order_no的哈希值为奇数时")]),s._v("，数据插入对应服务器的"),n("code",[s._v("t_order1表")]),s._v("。因为order_no是字符串形式，因此不能直接取模。")]),s._v(" "),n("div",{staticClass:"language-properties line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#------------------------分表策略")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分片列名称")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.tables.t_order.table-strategy.standard.sharding-column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("order_no")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分片算法名称")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.tables.t_order.table-strategy.standard.sharding-algorithm-name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("alg_hash_mod")]),s._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#------------------------分片算法配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 哈希取模分片算法")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分片算法类型")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.sharding-algorithms.alg_hash_mod.type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("HASH_MOD")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分片算法属性配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.sharding-algorithms.alg_hash_mod.props.sharding-count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("2")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("p",[s._v("测试前不要忘记将如下节点改回原来的状态")]),s._v(" "),n("div",{staticClass:"language-properties line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("xxx.actual-data-nodes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("server-order$->{0..1}.t_order$->{0..1}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("测试：")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 水平分片：分表插入数据测试\n     */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Test")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("testInsertOrderTableStrategy")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("long")]),s._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),s._v(" order "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setOrderNo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ATGUIGU"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setUserId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1L")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setAmount")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BigDecimal")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        orderMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("insert")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("long")]),s._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),s._v(" order "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setOrderNo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ATGUIGU"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setUserId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2L")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setAmount")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BigDecimal")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        orderMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("insert")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 测试哈希取模\n     */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Test")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("testHash")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//注意hash取模的结果是整个字符串hash后再取模，和数值后缀是奇数还是偶数无关")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ATGUIGU001"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("hashCode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ATGUIGU0011"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("hashCode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br")])]),n("p",[n("strong",[s._v("查询测试：")])]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 水平分片：查询所有记录\n     * 查询了两个数据源，每个数据源中使用UNION ALL连接两个表\n     */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Test")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("testShardingSelectAll")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" orders "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" orderMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("selectList")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    orders"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 水平分片：根据user_id查询记录\n     * 查询了一个数据源，每个数据源中使用UNION ALL连接两个表\n     */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Test")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("testShardingSelectByUserId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("QueryWrapper")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" orderQueryWrapper "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("QueryWrapper")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    orderQueryWrapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("eq")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user_id"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1L")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" orders "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" orderMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("selectList")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("orderQueryWrapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    orders"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br")])]),n("h4",{attrs:{id:"_2-6、分布式序列算法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-6、分布式序列算法"}},[s._v("#")]),s._v(" 2.6、分布式序列算法")]),s._v(" "),n("p",[n("strong",[s._v("雪花算法：")])]),s._v(" "),n("p",[s._v("https://shardingsphere.apache.org/document/5.1.1/cn/features/sharding/concept/key-generator/")]),s._v(" "),n("p",[s._v("水平分片需要关注全局序列，因为不能简单的使用基于数据库的主键自增。")]),s._v(" "),n("p",[s._v("这里有两种方案：一种是基于MyBatisPlus的id策略；一种是ShardingSphere-JDBC的全局序列配置。")]),s._v(" "),n("p",[n("code",[s._v("基于MyBatisPlus的id策略：")]),s._v("将Order类的id设置成如下形式")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@TableId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IdType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ASSIGN_ID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("code",[s._v("基于ShardingSphere-JDBC的全局序列配置")]),s._v("：和前面的MyBatisPlus的策略二选一")]),s._v(" "),n("div",{staticClass:"language-properties line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#------------------------分布式序列策略配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分布式序列列名称")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.tables.t_order.key-generate-strategy.column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("id")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分布式序列算法名称")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.tables.t_order.key-generate-strategy.key-generator-name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("alg_snowflake")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分布式序列算法配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分布式序列算法类型")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.key-generators.alg_snowflake.type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("SNOWFLAKE")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分布式序列算法属性配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#spring.shardingsphere.rules.sharding.key-generators.alg_snowflake.props.xxx=")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v("此时，需要将实体类中的id策略修改成以下形式：")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//当配置了shardingsphere-jdbc的分布式序列时，自动使用shardingsphere-jdbc的分布式序列")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//当没有配置shardingsphere-jdbc的分布式序列时，自动依赖数据库的主键自增策略")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@TableId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IdType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("AUTO"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h3",{attrs:{id:"_3、多表关联"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3、多表关联"}},[s._v("#")]),s._v(" 3、多表关联")]),s._v(" "),n("h4",{attrs:{id:"_3-1、创建关联表"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-1、创建关联表"}},[s._v("#")]),s._v(" 3.1、创建关联表")]),s._v(" "),n("p",[s._v("在"),n("code",[s._v("server-order0、server-order1")]),s._v("服务器中分别创建两张订单详情表"),n("code",[s._v("t_order_item0、t_order_item1")])]),s._v(" "),n("p",[s._v("我们希望"),n("code",[s._v("同一个用户的订单表和订单详情表中的数据都在同一个数据源中，避免跨库关联")]),s._v("，因此这两张表我们使用相同的分片策略。")]),s._v(" "),n("p",[s._v("那么在"),n("code",[s._v("t_order_item")]),s._v("中我们也需要创建"),n("code",[s._v("order_no")]),s._v("和"),n("code",[s._v("user_id")]),s._v("这两个分片键")]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" t_order_item0"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BIGINT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    order_no "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BIGINT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    price "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DECIMAL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" t_order_item1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BIGINT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    order_no "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    user_id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BIGINT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    price "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DECIMAL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])]),n("h4",{attrs:{id:"_3-2、创建实体类"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-2、创建实体类"}},[s._v("#")]),s._v(" 3.2、创建实体类")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("atguigu"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("shardingjdbcdemo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("entity")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@TableName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"t_order_item"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Data")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OrderItem")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//当配置了shardingsphere-jdbc的分布式序列时，自动使用shardingsphere-jdbc的分布式序列")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@TableId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IdType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("AUTO"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" orderNo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" userId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BigDecimal")]),s._v(" price"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Integer")]),s._v(" count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("h4",{attrs:{id:"_3-3、创建mapper"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-3、创建mapper"}},[s._v("#")]),s._v(" 3.3、创建Mapper")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("atguigu"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("shargingjdbcdemo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("mapper")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Mapper")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OrderItemMapper")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BaseMapper")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OrderItem")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h4",{attrs:{id:"_3-4、配置关联表"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-4、配置关联表"}},[s._v("#")]),s._v(" 3.4、配置关联表")]),s._v(" "),n("p",[s._v("t_order_item的分片表、分片策略、分布式序列策略和t_order一致")]),s._v(" "),n("div",{staticClass:"language-properties line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#------------------------标准分片表配置（数据节点配置）")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.tables.t_order_item.actual-data-nodes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("server-order$->{0..1}.t_order_item$->{0..1}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#------------------------分库策略")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分片列名称")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.tables.t_order_item.database-strategy.standard.sharding-column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("user_id")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分片算法名称")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.tables.t_order_item.database-strategy.standard.sharding-algorithm-name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("alg_mod")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#------------------------分表策略")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分片列名称")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.tables.t_order_item.table-strategy.standard.sharding-column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("order_no")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分片算法名称")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.tables.t_order_item.table-strategy.standard.sharding-algorithm-name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("alg_hash_mod")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#------------------------分布式序列策略配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分布式序列列名称")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.tables.t_order_item.key-generate-strategy.column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("id")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分布式序列算法名称")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.tables.t_order_item.key-generate-strategy.key-generator-name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("alg_snowflake")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])]),n("h4",{attrs:{id:"_3-5、测试插入数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-5、测试插入数据"}},[s._v("#")]),s._v(" 3.5、测试插入数据")]),s._v(" "),n("p",[s._v("同一个用户的订单表和订单详情表中的数据都在同一个数据源中，避免跨库关联")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 测试关联表插入\n     */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Test")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("testInsertOrderAndOrderItem")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("long")]),s._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),s._v(" order "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setOrderNo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ATGUIGU"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setUserId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1L")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        orderMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("insert")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("long")]),s._v(" j "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" j "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" j"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OrderItem")]),s._v(" orderItem "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OrderItem")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            orderItem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setOrderNo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ATGUIGU"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            orderItem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setUserId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1L")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            orderItem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setPrice")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BigDecimal")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            orderItem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setCount")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            orderItemMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("insert")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("orderItem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("long")]),s._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),s._v(" order "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setOrderNo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ATGUIGU"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setUserId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2L")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        orderMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("insert")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("long")]),s._v(" j "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" j "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" j"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OrderItem")]),s._v(" orderItem "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OrderItem")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            orderItem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setOrderNo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ATGUIGU"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            orderItem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setUserId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2L")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            orderItem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setPrice")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BigDecimal")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            orderItem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setCount")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            orderItemMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("insert")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("orderItem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br")])]),n("h3",{attrs:{id:"_4、绑定表"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4、绑定表"}},[s._v("#")]),s._v(" 4、绑定表")]),s._v(" "),n("p",[s._v("**需求：**查询每个订单的订单号和总订单金额")]),s._v(" "),n("h4",{attrs:{id:"_4-1、创建vo对象"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-1、创建vo对象"}},[s._v("#")]),s._v(" 4.1、创建VO对象")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("atguigu"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("shardingjdbcdemo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("entity")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Data")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OrderVo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" orderNo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BigDecimal")]),s._v(" amount"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h4",{attrs:{id:"_4-2、添加mapper方法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-2、添加mapper方法"}},[s._v("#")]),s._v(" 4.2、添加Mapper方法")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("atguigu"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("shardingjdbcdemo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("mapper")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Mapper")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OrderMapper")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BaseMapper")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Select")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SELECT o.order_no, SUM(i.price * i.count) AS amount"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"FROM t_order o JOIN t_order_item i ON o.order_no = i.order_no"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"GROUP BY o.order_no"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OrderVo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getOrderAmount")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("h4",{attrs:{id:"_4-3、测试关联查询"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-3、测试关联查询"}},[s._v("#")]),s._v(" 4.3、测试关联查询")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 测试关联表查询\n     */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Test")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("testGetOrderAmount")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OrderVo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" orderAmountList "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" orderMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getOrderAmount")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    orderAmountList"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h4",{attrs:{id:"_4-4、配置绑定表"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-4、配置绑定表"}},[s._v("#")]),s._v(" 4.4、配置绑定表")]),s._v(" "),n("p",[s._v("在原来水平分片配置的基础上添加如下配置：")]),s._v(" "),n("div",{staticClass:"language-properties line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#------------------------绑定表")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.binding-tables[0]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("t_order,t_order_item")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("配置完绑定表后再次进行关联查询的测试：")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("**如果不配置绑定表：测试的结果为8个SQL。**多表关联查询会出现笛卡尔积关联。")])]),s._v(" "),n("li",[n("p",[n("strong",[s._v("如果配置绑定表：测试的结果为4个SQL。")]),s._v(" 多表关联查询不会出现笛卡尔积关联，关联查询效率将大大提升。")])])]),s._v(" "),n("p",[n("code",[s._v("绑定表：")]),s._v("指分片规则一致的一组分片表。 使用绑定表进行多表关联查询时，必须使用分片键进行关联，否则会出现笛卡尔积关联或跨库关联，从而影响查询效率。")]),s._v(" "),n("h3",{attrs:{id:"_5、广播表"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5、广播表"}},[s._v("#")]),s._v(" 5、广播表")]),s._v(" "),n("h4",{attrs:{id:"_4-1、什么是广播表"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-1、什么是广播表"}},[s._v("#")]),s._v(" 4.1、什么是广播表")]),s._v(" "),n("p",[s._v("指所有的分片数据源中都存在的表，表结构及其数据在每个数据库中均完全一致。 适用于数据量不大且需要与海量数据的表进行关联查询的场景，例如：字典表。")]),s._v(" "),n("p",[s._v("广播具有以下特性：")]),s._v(" "),n("p",[s._v("（1）插入、更新操作会实时在所有节点上执行，保持各个分片的数据一致性")]),s._v(" "),n("p",[s._v("（2）查询操作，只从一个节点获取")]),s._v(" "),n("p",[s._v("（3）可以跟任何一个表进行 JOIN 操作")]),s._v(" "),n("h4",{attrs:{id:"_4-2、创建广播表"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-2、创建广播表"}},[s._v("#")]),s._v(" 4.2、创建广播表")]),s._v(" "),n("p",[s._v("在server-order0、server-order1和server-user服务器中分别创建t_dict表")]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" t_dict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    id "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BIGINT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    dict_type "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h4",{attrs:{id:"_4-3、程序实现"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-3、程序实现"}},[s._v("#")]),s._v(" 4.3、程序实现")]),s._v(" "),n("h5",{attrs:{id:"_4-3-1、创建实体类"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-1、创建实体类"}},[s._v("#")]),s._v(" 4.3.1、创建实体类")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("atguigu"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("shardingjdbcdemo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("entity")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@TableName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"t_dict"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Data")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Dict")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//可以使用MyBatisPlus的雪花算法")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@TableId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IdType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ASSIGN_ID"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" dictType"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h5",{attrs:{id:"_4-3-2、创建mapper"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-2、创建mapper"}},[s._v("#")]),s._v(" 4.3.2、创建Mapper")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("atguigu"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("shardingjdbcdemo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("mapper")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Mapper")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DictMapper")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BaseMapper")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Dict")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h5",{attrs:{id:"_4-3-3、配置广播表"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-3、配置广播表"}},[s._v("#")]),s._v(" 4.3.3、配置广播表")]),s._v(" "),n("div",{staticClass:"language-properties line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#数据节点可不配置，默认情况下，向所有数据源广播")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.tables.t_dict.actual-data-nodes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("server-user.t_dict,server-order$->{0..1}.t_dict")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 广播表")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.shardingsphere.rules.sharding.broadcast-tables[0]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("t_dict")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h4",{attrs:{id:"_4-4、测试广播表"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-4、测试广播表"}},[s._v("#")]),s._v(" 4.4、测试广播表")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DictMapper")]),s._v(" dictMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 广播表：每个服务器中的t_dict同时添加了新数据\n     */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Test")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("testBroadcast")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Dict")]),s._v(" dict "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Dict")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    dict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setDictType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    dictMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("insert")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 查询操作，只从一个节点获取数据\n     * 随机负载均衡规则\n     */")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Test")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("testSelectBroadcast")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Dict")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" dicts "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" dictMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("selectList")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    dicts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br")])]),n("h2",{attrs:{id:"第07章-启动shardingsphere-proxy"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第07章-启动shardingsphere-proxy"}},[s._v("#")]),s._v(" 第07章 启动ShardingSphere-Proxy")]),s._v(" "),n("h3",{attrs:{id:"_1、获取"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、获取"}},[s._v("#")]),s._v(" 1、获取")]),s._v(" "),n("p",[s._v("目前 ShardingSphere-Proxy 提供了 3 种获取方式：")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://shardingsphere.apache.org/document/5.1.1/cn/user-manual/shardingsphere-proxy/startup/bin/",target:"_blank",rel:"noopener noreferrer"}},[s._v("二进制发布包"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://shardingsphere.apache.org/document/5.1.1/cn/user-manual/shardingsphere-proxy/startup/docker/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"https://shardingsphere.apache.org/document/5.1.1/cn/user-manual/shardingsphere-proxy/startup/helm/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Helm"),n("OutboundLink")],1)])]),s._v(" "),n("h3",{attrs:{id:"_2、使用二进制发布包安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、使用二进制发布包安装"}},[s._v("#")]),s._v(" 2、使用二进制发布包安装")]),s._v(" "),n("p",[s._v("二进制包既可以Linux系统运行，又可以在windows系统运行")]),s._v(" "),n("p",[n("strong",[s._v("step1：解压二进制包")])]),s._v(" "),n("p",[n("code",[s._v("apache-shardingsphere-5.1.1-shardingsphere-proxy-bin.tar.gz")])]),s._v(" "),n("p",[s._v("windows：使用解压软件解压文件")]),s._v(" "),n("p",[s._v("Linux：将文件上传至/opt目录，并解压")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zxvf apache-shardingsphere-5.1.1-shardingsphere-proxy-bin.tar.gz\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("strong",[s._v("step2：MySQL驱动")])]),s._v(" "),n("p",[n("code",[s._v("mysql-connector-java-8.0.22.jar")])]),s._v(" "),n("p",[s._v("将MySQl驱动放至解压目录中的"),n("code",[s._v("ext-lib")]),s._v("目录")]),s._v(" "),n("p",[n("strong",[s._v("spte3：修改配置conf/server.yaml")])]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("rules")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token tag"}},[s._v("!AUTHORITY")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("users")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" root@%"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("root\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("provider")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ALL_PRIVILEGES_PERMITTED\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("props")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("sql-show")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("p",[n("strong",[s._v("spte4：启动ShardingSphere-Proxy")])]),s._v(" "),n("p",[s._v("Linux 操作系统请运行 "),n("code",[s._v("bin/start.sh")])]),s._v(" "),n("p",[s._v("Windows 操作系统请运行 "),n("code",[s._v("bin/start.bat")])]),s._v(" "),n("p",[s._v("指定端口号和配置文件目录："),n("code",[s._v("bin/start.bat ${proxy_port} ${proxy_conf_directory}")])]),s._v(" "),n("p",[n("strong",[s._v("step5：远程连接ShardingSphere-Proxy")])]),s._v(" "),n("p",[s._v("远程访问")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("mysql -h192.168.100.1 -P3307 -uroot -p\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("strong",[s._v("step6：访问测试")])]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("databases")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("img",{attrs:{src:t(483)}}),s._v(" "),n("h3",{attrs:{id:"_3、使用docker安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3、使用docker安装"}},[s._v("#")]),s._v(" 3、使用Docker安装")]),s._v(" "),n("p",[n("strong",[s._v("step1：启动Docker容器")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker run -d "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /atguigu/server/proxy-a/conf:/opt/shardingsphere-proxy/conf "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /atguigu/server/proxy-a/ext-lib:/opt/shardingsphere-proxy/ext-lib "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-e "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ES_JAVA_OPTS")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-Xmx256m -Xms256m -Xmn128m"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3321")]),s._v(":3307 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--name server-proxy-a "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\napache/shardingsphere-proxy:5.1.1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[n("strong",[s._v("step2：上传MySQL驱动")])]),s._v(" "),n("p",[s._v("将MySQl驱动上传至"),n("code",[s._v("/atguigu/server/proxy-a/ext-lib")]),s._v("目录")]),s._v(" "),n("p",[n("strong",[s._v("spte3：修改配置server.yaml")])]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("rules")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token tag"}},[s._v("!AUTHORITY")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("users")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" root@%"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("root\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("provider")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ALL_PRIVILEGES_PERMITTED\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("props")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("sql-show")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("p",[s._v("将配置文件上传至"),n("code",[s._v("/atguigu/server/proxy-a/conf")]),s._v("目录")]),s._v(" "),n("p",[n("strong",[s._v("spte4：重启容器")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker restart server-proxy-a\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("strong",[s._v("step5：远程连接ShardingSphere-Proxy")])]),s._v(" "),n("p",[s._v("ShardingSphere-Proxy容器中默认情况下没有mysql命令行客户端的安装，因此需要远程访问")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("mysql -h192.168.100.201 -P3321 -uroot -p\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("strong",[s._v("step6：访问测试")])]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("databases")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("img",{attrs:{src:t(483)}}),s._v(" "),n("p",[n("strong",[s._v("常见问题：docker容器无法远程连接")])]),s._v(" "),n("p",[s._v("容器可以成功的创建并启动，但是无法远程连接。排除防火墙和网络等问题后，看看是不是因为容器内存不足导致。")]),s._v(" "),n("p",[n("code",[s._v("原因：")]),s._v("容器可分配内存不足")]),s._v(" "),n("p",[n("code",[s._v("查看办法：")]),s._v("进入容器后查看ShardingSphere-Proxy的日志，如有有"),n("code",[s._v("cannot allocate memory")]),s._v("，则说明容器内存不足")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it server-proxy-a "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("env")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("LANG")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("C.UTF-8 /bin/bash\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /opt/shardingsphere-proxy/logs\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" stdout.log \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("img",{attrs:{src:t(566)}}),s._v(" "),n("p",[n("code",[s._v("解决方案：")]),s._v("创建容器的时候使用JVM参数")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("-e "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ES_JAVA_OPTS")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-Xmx256m -Xms256m -Xmn128m"')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"第08章-shardingsphere-proxy读写分离"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第08章-shardingsphere-proxy读写分离"}},[s._v("#")]),s._v(" 第08章 ShardingSphere-Proxy读写分离")]),s._v(" "),n("h3",{attrs:{id:"_1、修改配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、修改配置文件"}},[s._v("#")]),s._v(" 1、修改配置文件")]),s._v(" "),n("p",[n("strong",[s._v("修改配置config-readwrite-splitting.yaml")])]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("schemaName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" readwrite_splitting_db\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dataSources")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("write_ds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" jdbc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//192.168.100.201"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("3306/db_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("?")]),s._v("serverTimezone=UTC"),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("&useSSL=false")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("username")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" root\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("password")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("connectionTimeoutMilliseconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30000")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("idleTimeoutMilliseconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("60000")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxLifetimeMilliseconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1800000")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxPoolSize")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("minPoolSize")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("read_ds_0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" jdbc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//192.168.100.201"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("3307/db_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("?")]),s._v("serverTimezone=UTC"),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("&useSSL=false")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("username")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" root\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("password")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("connectionTimeoutMilliseconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30000")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("idleTimeoutMilliseconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("60000")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxLifetimeMilliseconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1800000")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxPoolSize")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("minPoolSize")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("read_ds_1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" jdbc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//192.168.100.201"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("3308/db_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("?")]),s._v("serverTimezone=UTC"),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("&useSSL=false")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("username")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" root\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("password")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("connectionTimeoutMilliseconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30000")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("idleTimeoutMilliseconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("60000")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxLifetimeMilliseconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1800000")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxPoolSize")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("minPoolSize")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("rules")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token tag"}},[s._v("!READWRITE_SPLITTING")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dataSources")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("readwrite_ds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Static\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("props")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("write-data-source-name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" write_ds\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("read-data-source-names")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" read_ds_0"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("read_ds_1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br")])]),n("p",[s._v("将配置文件上传至"),n("code",[s._v("/atguigu/server/proxy-a/conf")]),s._v("目录")]),s._v(" "),n("p",[n("strong",[s._v("重启容器")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker restart server-proxy-a\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"_2、实时查看日志"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、实时查看日志"}},[s._v("#")]),s._v(" 2、实时查看日志")]),s._v(" "),n("p",[s._v("可以通过这种方式查看服务器中输出的SQL语句")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it server-proxy-a "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("env")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("LANG")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("C.UTF-8 /bin/bash\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" -f /opt/shardingsphere-proxy/logs/stdout.log \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"_3、远程访问测试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3、远程访问测试"}},[s._v("#")]),s._v(" 3、远程访问测试")]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[s._v("mysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("databases")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" readwrite_splitting_db"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("tables")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" t_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" t_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("insert")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("into")]),s._v(" t_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("uname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("values")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'wang5'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h3",{attrs:{id:"_4、应用程序访问proxy"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4、应用程序访问proxy"}},[s._v("#")]),s._v(" 4、应用程序访问Proxy")]),s._v(" "),n("h4",{attrs:{id:"_4-1、创建项目"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-1、创建项目"}},[s._v("#")]),s._v(" 4.1、创建项目")]),s._v(" "),n("p",[s._v("项目类型：Spring Initializr")]),s._v(" "),n("p",[s._v("SpringBoot脚手架：http://start.aliyun.com")]),s._v(" "),n("p",[s._v("项目名：sharding-proxy-demo")]),s._v(" "),n("p",[s._v("SpringBoot版本：2.3.7.RELEASE")]),s._v(" "),n("h4",{attrs:{id:"_4-2、添加依赖"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-2、添加依赖"}},[s._v("#")]),s._v(" 4.2、添加依赖")]),s._v(" "),n("div",{staticClass:"language-xml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-xml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependencies")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.springframework.boot"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("spring-boot-starter-web"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("mysql"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("mysql-connector-java"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("scope")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("runtime"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("scope")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("com.baomidou"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("mybatis-plus-boot-starter"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("3.3.1"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.projectlombok"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("lombok"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("optional")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("true"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("optional")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.springframework.boot"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("spring-boot-starter-test"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("scope")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("test"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("scope")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("exclusions")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("exclusion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.junit.vintage"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("junit-vintage-engine"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("exclusion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("exclusions")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependencies")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br")])]),n("h4",{attrs:{id:"_4-3、创建实体类"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-3、创建实体类"}},[s._v("#")]),s._v(" 4.3、创建实体类")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("atguigu"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("shardingproxydemo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("entity")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@TableName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"t_user"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Data")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@TableId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IdType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("AUTO"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" uname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h4",{attrs:{id:"_4-4、创建mapper"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-4、创建mapper"}},[s._v("#")]),s._v(" 4.4、创建Mapper")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("atguigu"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("shardingproxydemo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("mapper")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Mapper")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UserMapper")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BaseMapper")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h4",{attrs:{id:"_4-5、配置数据源"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-5、配置数据源"}},[s._v("#")]),s._v(" 4.5、配置数据源")]),s._v(" "),n("div",{staticClass:"language-properties line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 应用名称")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.application.name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("sharding-proxy-demo")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开发环境设置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.profiles.active")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("dev")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#mysql数据库连接（proxy）")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.datasource.driver-class-name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("com.mysql.jdbc.Driver")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.datasource.url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("jdbc:mysql://192.168.100.201:3321/readwrite_splitting_db?serverTimezone=GMT%2B8&useSSL=false")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.datasource.username")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("root")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("spring.datasource.password")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("root")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#mybatis日志")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("mybatis-plus.configuration.log-impl")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("org.apache.ibatis.logging.stdout.StdOutImpl")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("h4",{attrs:{id:"_4-6、测试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-6、测试"}},[s._v("#")]),s._v(" 4.6、测试")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("atguigu"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("shardingproxydemo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@SpringBootTest")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ShardingProxyDemoApplicationTests")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UserMapper")]),s._v(" userMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 读数据测试\n     */")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Test")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("testSelectAll")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),n("span",{pre:!0,attrs:{class:"token generics"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" users "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" userMapper"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("selectList")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])]),n("h2",{attrs:{id:"第09章-shardingsphere-proxy垂直分片"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第09章-shardingsphere-proxy垂直分片"}},[s._v("#")]),s._v(" 第09章 ShardingSphere-Proxy垂直分片")]),s._v(" "),n("h3",{attrs:{id:"_1、修改配置文件-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、修改配置文件-2"}},[s._v("#")]),s._v(" 1、修改配置文件")]),s._v(" "),n("p",[n("strong",[s._v("修改配置config-sharding.yaml")])]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("schemaName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" sharding_db\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dataSources")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ds_0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" jdbc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//192.168.100.201"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("3301/db_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("?")]),s._v("serverTimezone=UTC"),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("&useSSL=false")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("username")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" root\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("password")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("connectionTimeoutMilliseconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30000")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("idleTimeoutMilliseconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("60000")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxLifetimeMilliseconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1800000")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxPoolSize")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("minPoolSize")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ds_1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" jdbc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//192.168.100.201"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("3302/db_order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("?")]),s._v("serverTimezone=UTC"),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("&useSSL=false")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("username")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" root\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("password")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("connectionTimeoutMilliseconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30000")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("idleTimeoutMilliseconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("60000")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxLifetimeMilliseconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1800000")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxPoolSize")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("minPoolSize")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("rules")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token tag"}},[s._v("!SHARDING")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("tables")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("t_user")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("actualDataNodes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ds_0.t_user\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("t_order")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("actualDataNodes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ds_1.t_order\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br")])]),n("h3",{attrs:{id:"_2、实时查看日志-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、实时查看日志-2"}},[s._v("#")]),s._v(" 2、实时查看日志")]),s._v(" "),n("p",[s._v("可以通过这种方式查看服务器中输出的SQL语句")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it server-proxy-a "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("env")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("LANG")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("C.UTF-8 /bin/bash\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" -f /opt/shardingsphere-proxy/logs/stdout.log \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"_3、远程访问测试-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3、远程访问测试-2"}},[s._v("#")]),s._v(" 3、远程访问测试")]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[s._v("mysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("databases")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" sharding_db"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("tables")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" t_order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" t_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h2",{attrs:{id:"第10章-shardingsphere-proxy水平分片"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第10章-shardingsphere-proxy水平分片"}},[s._v("#")]),s._v(" 第10章 ShardingSphere-Proxy水平分片")]),s._v(" "),n("h3",{attrs:{id:"_1、修改配置文件-3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、修改配置文件-3"}},[s._v("#")]),s._v(" 1、修改配置文件")]),s._v(" "),n("p",[n("strong",[s._v("修改配置config-sharding.yaml")])]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("schemaName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" sharding_db\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dataSources")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ds_user")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" jdbc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//192.168.100.201"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("3301/db_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("?")]),s._v("serverTimezone=UTC"),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("&useSSL=false")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("username")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" root\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("password")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("connectionTimeoutMilliseconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30000")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("idleTimeoutMilliseconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("60000")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxLifetimeMilliseconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1800000")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxPoolSize")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("minPoolSize")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ds_order0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" jdbc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//192.168.100.201"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("3310/db_order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("?")]),s._v("serverTimezone=UTC"),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("&useSSL=false")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("username")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" root\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("password")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("connectionTimeoutMilliseconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30000")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("idleTimeoutMilliseconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("60000")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxLifetimeMilliseconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1800000")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxPoolSize")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("minPoolSize")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ds_order1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" jdbc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//192.168.100.201"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("3311/db_order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("?")]),s._v("serverTimezone=UTC"),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("&useSSL=false")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("username")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" root\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("password")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("connectionTimeoutMilliseconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("30000")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("idleTimeoutMilliseconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("60000")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxLifetimeMilliseconds")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1800000")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxPoolSize")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("minPoolSize")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("rules")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token tag"}},[s._v("!SHARDING")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("tables")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("t_user")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("actualDataNodes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ds_user.t_user\n\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("t_order")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("actualDataNodes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ds_order$"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("0..1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(".t_order$"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("0..1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("databaseStrategy")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("standard")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("shardingColumn")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" user_id\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("shardingAlgorithmName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" alg_mod\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("tableStrategy")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("standard")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("shardingColumn")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" order_no\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("shardingAlgorithmName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" alg_hash_mod\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("keyGenerateStrategy")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" id\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("keyGeneratorName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" snowflake\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("t_order_item")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("actualDataNodes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ds_order$"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("0..1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(".t_order_item$"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("0..1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("databaseStrategy")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("standard")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("shardingColumn")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" user_id\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("shardingAlgorithmName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" alg_mod\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("tableStrategy")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("standard")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("shardingColumn")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" order_no\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("shardingAlgorithmName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" alg_hash_mod\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("keyGenerateStrategy")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" id\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("keyGeneratorName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" snowflake\n\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("bindingTables")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" t_order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("t_order_item\n\n\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("broadcastTables")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" t_dict\n\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("shardingAlgorithms")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("alg_inline_userid")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" INLINE\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("props")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("algorithm-expression")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" server"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("order$"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("user_id % 2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("alg_mod")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" MOD\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("props")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("sharding-count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("alg_hash_mod")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" HASH_MOD\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("props")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("sharding-count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n  \n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("keyGenerators")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("snowflake")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" SNOWFLAKE\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br")])]),n("h3",{attrs:{id:"_2、实时查看日志-3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、实时查看日志-3"}},[s._v("#")]),s._v(" 2、实时查看日志")]),s._v(" "),n("p",[s._v("可以通过这种方式查看服务器中输出的SQL语句")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it server-proxy-a "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("env")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("LANG")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("C.UTF-8 /bin/bash\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" -f /opt/shardingsphere-proxy/logs/stdout.log \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"_3、远程访问测试-3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3、远程访问测试-3"}},[s._v("#")]),s._v(" 3、远程访问测试")]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[s._v("mysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("databases")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" sharding_db"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("tables")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" t_order"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--测试水平分片")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" t_dict"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--测试广播表")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{682:function(s,t,a){"use strict";a.r(t);var n=a(7),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"列的选择性-也称为区分度"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#列的选择性-也称为区分度"}},[s._v("#")]),s._v(" 列的选择性（也称为区分度）")]),s._v(" "),a("p",[s._v("列的选择性（也称为区分度）是指某一列中不同值的个数与表中总行数的比值。这个概念对于索引设计非常重要。")]),s._v(" "),a("p",[s._v("计算公式：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("选择性 = 列的不同值数量 / 表的总行数\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("具体解释：")]),s._v(" "),a("ol",[a("li",[s._v("选择性的值范围在0到1之间")]),s._v(" "),a("li",[s._v("值越接近1，说明列的选择性越高")]),s._v(" "),a("li",[s._v("值越接近0，说明列的选择性越低")])]),s._v(" "),a("p",[s._v("举例说明：")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 假设有一个用户表：")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" users "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    id "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    gender "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    email "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    city "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 计算选择性的SQL")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("COUNT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DISTINCT")]),s._v(" column_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("COUNT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" selectivity\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" table_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 例如：")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('-- gender列：可能只有"男"、"女"两个值，如果有1000条记录')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 选择性 = 2/1000 = 0.002（低选择性）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("COUNT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DISTINCT")]),s._v(" gender"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("COUNT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" users"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- email列：每个用户邮箱都不同，如果有1000条记录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 选择性 = 1000/1000 = 1（高选择性）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("COUNT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DISTINCT")]),s._v(" email"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("COUNT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" users"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("p",[s._v("低选择性的特点：")]),s._v(" "),a("ol",[a("li",[s._v("列中存在大量重复值。列的选择性低就意味着数据的离散度低，也就是说数据的重复度高。")]),s._v(" "),a("li",[s._v("不同值的个数远少于总记录数")]),s._v(" "),a("li",[s._v("通常不适合单独建立索引")]),s._v(" "),a("li",[s._v("例如：性别、状态、级别等字段")])]),s._v(" "),a("p",[s._v("高选择性的特点：")]),s._v(" "),a("ol",[a("li",[s._v("列中的值大多是唯一的")]),s._v(" "),a("li",[s._v("不同值的个数接近总记录数")]),s._v(" "),a("li",[s._v("适合建立索引")]),s._v(" "),a("li",[s._v("例如：主键、邮箱、手机号等字段")])]),s._v(" "),a("p",[s._v("常见列的选择性参考：")]),s._v(" "),a("ol",[a("li",[s._v("主键列：选择性 = 1（最高）")]),s._v(" "),a("li",[s._v("唯一键列：选择性 = 1")])]),s._v(" "),a("p",[s._v("选择性的应用：")]),s._v(" "),a("ol",[a("li",[s._v("索引设计\n"),a("ul",[a("li",[s._v("高选择性的列适合作为索引")]),s._v(" "),a("li",[s._v("在复合索引中，通常将选择性高的列放在前面")])])]),s._v(" "),a("li",[s._v("实际应用建议：\n"),a("ul",[a("li",[s._v("选择性低于0.1的列通常不适合单独建立索引")]),s._v(" "),a("li",[s._v("复合索引中，建议将选择性高的列放在前面")]),s._v(" "),a("li",[s._v("需要结合实际查询场景来权衡")])])])]),s._v(" "),a("p",[s._v("注意事项：")]),s._v(" "),a("ol",[a("li",[s._v("不能单纯依据选择性来决定索引策略")]),s._v(" "),a("li",[s._v("需要结合查询频率、表大小等因素")]),s._v(" "),a("li",[s._v("要考虑数据分布的均匀性")]),s._v(" "),a("li",[s._v("定期评估索引的使用效果")])]),s._v(" "),a("p",[s._v("通过合理利用列的选择性特征，可以帮助我们设计出更高效的索引策略，从而提升查询性能。但要注意，选择性只是众多考虑因素中的一个，还需要结合具体的业务场景和查询模式来综合考虑。")]),s._v(" "),a("h2",{attrs:{id:"单列索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#单列索引"}},[s._v("#")]),s._v(" 单列索引")]),s._v(" "),a("p",[s._v("适用场景：")]),s._v(" "),a("ol",[a("li",[s._v("列独立作为查询条件的频率高")]),s._v(" "),a("li",[s._v("列的选择性较高")]),s._v(" "),a("li",[s._v("需要支持范围查询的列")])]),s._v(" "),a("h2",{attrs:{id:"复合索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#复合索引"}},[s._v("#")]),s._v(" 复合索引")]),s._v(" "),a("p",[s._v("复合索引(Composite Index)是数据库中一种特殊的索引类型，它包含两个或多个列的组合。")]),s._v(" "),a("p",[s._v("主要特点：")]),s._v(" "),a("ol",[a("li",[s._v("多列组合：由多个字段共同组成一个索引")]),s._v(" "),a("li",[s._v("有序性：按照创建索引时指定的列顺序进行排序")]),s._v(" "),a("li",[s._v("最左匹配原则：必须按照索引最左边的列开始匹配才能生效")])]),s._v(" "),a("p",[s._v("适用场景：")]),s._v(" "),a("ol",[a("li",[s._v("多列经常一起作为查询条件")]),s._v(" "),a("li",[s._v("查询条件遵循最左前缀原则")]),s._v(" "),a("li",[s._v("列的组合具有较高的选择性（返回的记录数较少）")]),s._v(" "),a("li",[s._v("多列经常一起作为排序条件")]),s._v(" "),a("li",[s._v("有范围查询需求的场合")])]),s._v(" "),a("p",[s._v("举例说明：")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 创建一个复合索引")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" idx_your_table_1 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" your_table "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("column_1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" column_2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" column_3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 以下查询可以使用该索引")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" your_table "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" column_1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value_1'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("AND")]),s._v(" column_2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value_2'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("AND")]),s._v(" column_3 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value_3'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" your_table "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" column_1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value_1'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("AND")]),s._v(" column_2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value_2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 符合最左匹配")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" your_table "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" column_1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value_1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 符合最左匹配")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 以下查询无法使用该索引")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" your_table "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" column_2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value_2'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("AND")]),s._v(" column_3 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value_3'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 没有使用第一个索引列")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" your_table "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" column_2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value_2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 没有使用第一个索引列")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" your_table "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" column_3 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value_3'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 没有使用第一个索引列")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 以下查询不能完全使用该索引")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" your_table "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" column_1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value_1'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("AND")]),s._v(" column_3 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value_3'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 仅使用第一个索引列")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("对于复合索引 idx_your_table_1 (column_1, column_2, column_3)，当查询条件只有 column_1 和 column_3 时，这个索引只能部分生效，且效率不是最优的。这是因为：")]),s._v(" "),a("ol",[a("li",[a("p",[s._v('复合索引的工作原理遵循"最左前缀"原则：')]),s._v(" "),a("ul",[a("li",[s._v("可以使用索引的情况：使用第一列(column_1)")]),s._v(" "),a("li",[s._v("可以使用索引的情况：使用第一列和第二列(column_1, column_2)")]),s._v(" "),a("li",[s._v("可以使用索引的情况：使用全部三列(column_1, column_2, column_3)")]),s._v(" "),a("li",[s._v("不能完全使用索引的情况：跳过中间列(column_1, column_3)")])])]),s._v(" "),a("li",[a("p",[s._v("在您的查询场景中(column_1和column_3)：")]),s._v(" "),a("ul",[a("li",[s._v("索引会使用column_1部分")]),s._v(" "),a("li",[s._v("由于跳过了column_2，column_3部分将无法使用索引")]),s._v(" "),a("li",[s._v("数据库需要在筛选出的column_1结果集上进行column_2的过滤")])])])]),s._v(" "),a("p",[s._v("优点：")]),s._v(" "),a("ol",[a("li",[s._v("可以减少索引的数量")]),s._v(" "),a("li",[s._v("提高查询效率")]),s._v(" "),a("li",[s._v("优化存储空间")])]),s._v(" "),a("p",[s._v("注意事项：")]),s._v(" "),a("ol",[a("li",[s._v("遵循最左匹配原则")]),s._v(" "),a("li",[s._v("合理控制索引列的数量（通常不超过5个）")]),s._v(" "),a("li",[s._v("考虑列的选择性（区分度）")]),s._v(" "),a("li",[s._v("需要权衡查询性能和写入性能")])]),s._v(" "),a("p",[s._v("最佳实践：")]),s._v(" "),a("ol",[a("li",[s._v("将查询频率最高的列放在最左边")]),s._v(" "),a("li",[s._v("将选择性最高的列放在最左边")]),s._v(" "),a("li",[s._v("避免创建冗余的索引")]),s._v(" "),a("li",[s._v("定期监控索引的使用情况")])]),s._v(" "),a("h2",{attrs:{id:"位图索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#位图索引"}},[s._v("#")]),s._v(" 位图索引")]),s._v(" "),a("p",[s._v("位图索引(Bitmap Index)是一种特殊的数据库索引，它使用位数组来表示每个唯一值的行位置。")]),s._v(" "),a("p",[s._v("位图索引的工作原理：")]),s._v(" "),a("ol",[a("li",[s._v("为每个唯一值创建一个位图（位向量）")]),s._v(" "),a("li",[s._v("位图中的每一位对应表中的一行")]),s._v(" "),a("li",[s._v("如果该行包含这个值，相应位置为1，否则为0")])]),s._v(" "),a("p",[s._v("示例说明：")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 假设有一个用户表")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" users "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    id "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    gender "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 值只有 'M' 和 'F'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 为列gender创建位图索引")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" BITMAP "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" idx_gender "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" users"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("gender"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 数据示例：")]),s._v("\nid  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" gender\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" M\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" F\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" M\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" F\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" M\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 位图索引表示：")]),s._v("\nM: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 表示gender='M'的行")]),s._v("\nF: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 表示gender='F'的行")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("p",[s._v("不同数据库对位图索引的支持：")]),s._v(" "),a("ol",[a("li",[s._v("Oracle：完全支持位图索引")]),s._v(" "),a("li",[s._v("PostgreSQL：不直接支持位图索引，但有位图扫描操作")]),s._v(" "),a("li",[s._v("MySQL：不支持位图索引")]),s._v(" "),a("li",[s._v("SQL Server：不直接支持位图索引，但有类似的位图过滤器")])]),s._v(" "),a("p",[s._v("适用场景：")]),s._v(" "),a("ol",[a("li",[s._v("低选择性的列（重复值多的列）")]),s._v(" "),a("li",[s._v("静态数据（数据更新频率低）")]),s._v(" "),a("li",[s._v("大量的批量查询操作")]),s._v(" "),a("li",[s._v("经常需要进行AND和OR运算的查询")])]),s._v(" "),a("p",[s._v("优点：")]),s._v(" "),a("ol",[a("li",[s._v("存储空间效率高")]),s._v(" "),a("li",[s._v("适合多条件组合查询")]),s._v(" "),a("li",[s._v("对于低选择性列的查询性能好")]),s._v(" "),a("li",[s._v("支持快速的位运算")])]),s._v(" "),a("p",[s._v("缺点：")]),s._v(" "),a("ol",[a("li",[s._v("不适合频繁更新的数据")]),s._v(" "),a("li",[s._v("不适合高选择性的列")]),s._v(" "),a("li",[s._v("DML操作（插入、更新、删除）性能较差")])]),s._v(" "),a("p",[s._v("最佳实践：")]),s._v(" "),a("ol",[a("li",[s._v("对于低选择性的列使用位图索引")]),s._v(" "),a("li",[s._v("适用于数据仓库等读多写少的场景")]),s._v(" "),a("li",[s._v("避免在OLTP系统中使用")]),s._v(" "),a("li",[s._v("考虑列的基数（不同值的数量）")])]),s._v(" "),a("p",[s._v("使用建议：")]),s._v(" "),a("ol",[a("li",[s._v("当列的不同值数量少于总行数的1%时考虑使用")]),s._v(" "),a("li",[s._v("适合布尔值、状态码等低选择性列")]),s._v(" "),a("li",[s._v("需要评估数据更新频率")]),s._v(" "),a("li",[s._v("考虑多个位图索引的组合效果")])]),s._v(" "),a("p",[s._v("注意事项：")]),s._v(" "),a("ol",[a("li",[s._v("在高并发更新环境下避免使用")]),s._v(" "),a("li",[s._v("需要考虑存储空间和维护成本")]),s._v(" "),a("li",[s._v("要评估查询模式是否适合位图索引")]),s._v(" "),a("li",[s._v("不同数据库的实现方式可能不同")])]),s._v(" "),a("p",[s._v("总结：")]),s._v(" "),a("ol",[a("li",[s._v("位图索引特别适合低选择性的列")]),s._v(" "),a("li",[s._v("主要用于数据仓库等读密集型应用")]),s._v(" "),a("li",[s._v("不是所有数据库都支持位图索引")]),s._v(" "),a("li",[s._v("需要根据具体场景和数据库特性来决定是否使用")])])])}),[],!1,null,null,null);t.default=e.exports}}]);